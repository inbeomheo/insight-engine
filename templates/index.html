<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Insight Engine — AI Content Analysis</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <!-- FOUC 방지: DOM 로드 전 저장된 테마 적용 -->
    <script>
        (function() {
            const storageKey = 'cad_theme_v1';
            const saved = localStorage.getItem(storageKey);
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

            let theme;
            if (saved === 'light') {
                theme = 'light';
            } else if (saved === 'dark') {
                theme = 'dark';
            } else {
                // system 또는 저장 없음 → 시스템 설정 따름
                theme = prefersDark ? 'dark' : 'light';
            }

            document.documentElement.setAttribute('data-theme', theme);
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <!-- 폰트 최적화: preconnect 및 preload -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin/>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin/>
    <!-- 웹폰트: Pretendard (한글, 메인) + Space Grotesk (영문 디스플레이) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                screens: {
                    'xs': '375px',
                    'sm': '640px',
                    'md': '768px',
                    'lg': '1024px',
                    'xl': '1280px',
                    '2xl': '1536px'
                },
                extend: {
                    colors: {
                        // 새로운 틸(Teal) 컬러 시스템
                        "primary": "#0f758a",
                        "primary-hover": "#0d6577",
                        "primary": "#0f758a",
                        "primary-glow": "#14a3bd",
                        // 배경/표면
                        "background-dark": "#16191d",
                        "background-base": "#16191d",
                        "surface-dark": "#202428",
                        "card-dark": "#202428",
                        "bg-elevated": "#282c31",
                        // 텍스트
                        "text-light": "#ffffff",
                        "text-primary": "#ffffff",
                        "text-secondary": "#9ca3af",
                        "text-subtle": "#93bfc8",
                        "gray-text": "#9ca3af",
                        "warm-white": "#ffffff",
                        // 테두리
                        "border-dark": "#2a2e33",
                        "card-border": "#345d65"
                    },
                    fontFamily: {
                        "display": ["Space Grotesk", "Pretendard", "sans-serif"],
                        "body": ["Space Grotesk", "Pretendard", "sans-serif"],
                        "mono": ["JetBrains Mono", "monospace"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "2xl": "1rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        /* ==================== Base Styles - Teal Design System ==================== */

        /* ========== Light Mode (기본) ========== */
        :root {
            --primary: #0f758a;
            --primary-hover: #0d6577;
            --primary-glow: #14a3bd;
            --background-dark: #f5f7f9;
            --surface-dark: #ffffff;
            --card-dark: #ffffff;
            --bg-elevated: #e8ecef;
            --text-primary: #1f2937;
            --text-muted: #6b7280;
            --text-subtle: #0f758a;
            --border-dark: #e5e7eb;
            --card-border: #0f758a40;
            /* Compact Design Variables */
            --spacing-xs: 0.25rem;   /* 4px */
            --spacing-sm: 0.5rem;    /* 8px */
            --spacing-md: 0.75rem;   /* 12px */
            --spacing-lg: 1rem;      /* 16px */
            --spacing-xl: 1.25rem;   /* 20px */
        }

        /* ========== Dark Mode ========== */
        [data-theme="dark"] {
            --primary: #0f758a;
            --primary-hover: #0d6577;
            --primary-glow: #14a3bd;
            --background-dark: #16191d;
            --surface-dark: #202428;
            --card-dark: #202428;
            --bg-elevated: #282c31;
            --text-primary: #ffffff;
            --text-muted: #9ca3af;
            --text-subtle: #93bfc8;
            --border-dark: #2a2e33;
            --card-border: #345d65;
        }

        /* ==================== 3-Column Layout Grid System ==================== */

        /* Main Layout Container */
        .app-layout {
            display: flex;
            height: 100vh;
            width: 100%;
            overflow: hidden;
        }

        /* Sidebar - 200px fixed width */
        #sidebar {
            width: 200px !important;
            min-width: 200px;
            max-width: 200px;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-dark);
            background: var(--background-dark);
            height: 100%;
            z-index: 50;
        }

        /* Input Panel - 350px fixed width */
        #input-panel {
            width: 350px !important;
            min-width: 320px;
            max-width: 400px;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-dark);
            background: var(--background-dark);
            height: 100%;
            overflow-y: auto;
        }

        /* Result Panel - flex-1 (remaining space) */
        #result-panel {
            flex: 1 1 0%;
            min-width: 400px;
            display: flex;
            flex-direction: column;
            background: var(--background-dark);
            height: 100%;
            overflow-y: auto;
        }

        /* Main Content Area - contains input and result panels */
        #main-content {
            flex: 1;
            display: flex;
            height: 100%;
            overflow: hidden;
        }

        /* Main Container - flex column for header + content */
        .main-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
        }

        /* Content Area - flex row for panels */
        .content-area {
            flex: 1;
            display: flex;
            height: 100%;
            overflow: hidden;
        }

        /* ==================== Compact Design System ==================== */

        /* Header - 56px → 48px */
        header.h-14 { height: 48px !important; }

        /* Sidebar internal layout */
        #sidebar .sidebar-header {
            height: 48px !important;
            padding: 0 var(--spacing-md);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            border-bottom: 1px solid var(--border-dark);
        }
        #sidebar .sidebar-logo {
            width: 28px !important;
            height: 28px !important;
            flex-shrink: 0;
        }
        #sidebar .sidebar-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        #sidebar .nav-icon-btn {
            width: 100% !important;
            height: 40px !important;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: 0 var(--spacing-md);
            border-radius: var(--radius-md);
            transition: background-color 0.2s, color 0.2s;
        }
        #sidebar .nav-icon-btn .material-symbols-outlined {
            font-size: 20px !important;
            flex-shrink: 0;
        }
        #sidebar .nav-icon-btn .nav-label {
            font-size: 13px;
            font-weight: 500;
            white-space: nowrap;
        }

        /* Input Panel Sections - p-4 → p-3 */
        #input-panel > div.p-4 { padding: 0.75rem !important; }
        #input-panel > div.p-4.border-b { padding: 0.75rem !important; }

        /* Section Headers - mb-3 → mb-2 */
        #input-panel .mb-3 { margin-bottom: 0.5rem !important; }
        #input-panel .mb-4 { margin-bottom: 0.75rem !important; }

        /* Gaps - gap-2 → gap-1.5, gap-3 → gap-2 */
        #input-panel .gap-2 { gap: 0.375rem !important; }
        #input-panel .gap-3 { gap: 0.5rem !important; }
        #input-panel .gap-1\.5 { gap: 0.25rem !important; }

        /* Space-y adjustments */
        #input-panel .space-y-2 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.375rem !important; }
        #input-panel .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.5rem !important; }

        /* Input fields - py-2.5 → py-2 */
        #input-panel input.py-2\.5,
        #input-panel select.py-2\.5 { padding-top: 0.5rem !important; padding-bottom: 0.5rem !important; }
        #input-panel .px-3 { padding-left: 0.5rem !important; padding-right: 0.5rem !important; }

        /* Style cards - smaller padding */
        #input-panel .style-card,
        #input-panel [class*="style-options"] label > div {
            padding: 0.375rem 0.625rem !important;
        }

        /* Buttons - smaller */
        #input-panel button.py-3 { padding-top: 0.625rem !important; padding-bottom: 0.625rem !important; }
        #input-panel button.py-2\.5 { padding-top: 0.5rem !important; padding-bottom: 0.5rem !important; }

        /* Result Panel Header */
        #result-panel > div > div.p-4 { padding: 0.75rem !important; }

        /* Report cards - compact spacing */
        .report-card { margin-bottom: 0.75rem !important; }
        .report-card .p-4 { padding: 0.75rem !important; }
        .report-card .p-6 { padding: 1rem !important; }

        /* Modal - compact */
        .modal-content.p-6 { padding: 1rem !important; }
        .modal-content .mb-6 { margin-bottom: 1rem !important; }
        .modal-content .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.75rem !important; }
        .modal-content .space-y-3 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.5rem !important; }

        /* Alert - compact */
        .alert { padding: 0.625rem 1rem !important; margin-bottom: 0.75rem !important; }

        /* Provider card - compact */
        .provider-card { padding: 0.75rem !important; }

        /* History item - compact */
        .history-item { padding: 0.75rem !important; }
        .history-item-header { margin-bottom: 0.375rem !important; }

        /* Header elements - compact */
        header .px-6 { padding-left: 1rem !important; padding-right: 1rem !important; }
        header .gap-3 { gap: 0.5rem !important; }
        header .px-3 { padding-left: 0.5rem !important; padding-right: 0.5rem !important; }
        header .py-1\.5 { padding-top: 0.25rem !important; padding-bottom: 0.25rem !important; }

        /* Report content - slightly tighter */
        .report-content { line-height: 1.6 !important; }
        .report-content h1 { margin: 1rem 0 0.5rem 0 !important; }
        .report-content h2 { margin: 0.875rem 0 0.375rem 0 !important; }
        .report-content h3 { margin: 0.75rem 0 0.25rem 0 !important; }
        .report-content p { margin: 0.5rem 0 !important; }
        .report-content ul, .report-content ol { margin: 0.5rem 0 !important; }
        .report-content li { margin: 0.25rem 0 !important; }
        .report-content blockquote { margin: 0.75rem 0 !important; padding: 0.75rem 1rem !important; }
        .report-content pre { margin: 0.75rem 0 !important; padding: 0.75rem !important; }
        .report-content table { margin: 1rem 0 !important; }
        .report-content th, .report-content td { padding: 0.625rem 1rem !important; }
        .report-content .highlight-box, .report-content .key-point { margin: 1rem 0 !important; padding: 1rem !important; }
        .report-content .summary, .report-content .executive-summary { padding: 1rem !important; margin: 1rem 0 !important; }

        /* Advanced options panel - compact */
        #advanced-options-panel.p-4 { padding: 0.75rem !important; }
        #advanced-options-panel .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.75rem !important; }
        #advanced-options-panel label > div.p-2 { padding: 0.375rem !important; }

        /* Dashboard/History/Usage views - compact */
        #dashboard-view .p-4 { padding: 0.75rem !important; }
        #history-view .p-4 { padding: 0.75rem !important; }
        #usage-view .p-4 { padding: 0.75rem !important; }

        /* URL list container - compact */
        #url-list-container { max-height: 120px !important; }
        #url-list-container .space-y-1\.5 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.25rem !important; }

        /* Style section labels - tighter */
        #input-panel .text-\[10px\] { margin-bottom: 0.375rem !important; }

        /* Flex wrap gaps - compact */
        .flex-wrap.gap-1\.5 { gap: 0.25rem !important; }
        .flex-wrap.gap-2 { gap: 0.375rem !important; }

        /* Panel view headers - compact */
        .panel-view .p-4.border-b { padding: 0.625rem 0.75rem !important; }

        /* Icon sizes in compact mode */
        #input-panel .material-symbols-outlined.text-sm { font-size: 14px !important; }
        #input-panel .material-symbols-outlined.text-base { font-size: 15px !important; }
        #input-panel .material-symbols-outlined.text-lg { font-size: 18px !important; }

        /* Select dropdowns - compact */
        #input-panel select { padding: 0.5rem 2rem 0.5rem 0.5rem !important; }

        /* Result panel - compact header and content */
        #result-panel .text-lg { font-size: 1rem !important; }
        #result-panel .border-b.flex-shrink-0 { padding: 0.625rem 0.75rem !important; }

        /* Stats badges - compact */
        .stats-badge { padding: 0.125rem 0.5rem !important; font-size: 0.625rem !important; }

        /* Cards container - reduce spacing */
        #cards-container { padding: 0.75rem !important; }
        #cards-container > * { margin-bottom: 0.75rem !important; }

        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        /* Focus styles for accessibility */
        :focus-visible {
            outline: 2px solid #0f758a;
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(15, 117, 138, 0.2);
        }

        /* Remove default focus for mouse users */
        :focus:not(:focus-visible) {
            outline: none;
            box-shadow: none;
        }

        /* Skip link for keyboard users */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #0f758a;
            color: #ffffff;
            padding: 8px 16px;
            z-index: 100;
            transition: top 0.2s;
        }
        .skip-link:focus {
            top: 0;
        }

        .glass-panel {
            background: #1a1d21;
            border: 1px solid #2a2e33;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #16191d;
        }
        ::-webkit-scrollbar-thumb {
            background: #345d65;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #0f758a;
        }

        /* Subtle shadow */
        .warm-glow {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        .warm-glow:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        /* Animations */
        .animate-pulse-slow {
            animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(2deg); }
        }
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        .animate-shimmer {
            background: linear-gradient(90deg, transparent, rgba(15, 117, 138, 0.1), transparent);
            background-size: 200% 100%;
            animation: shimmer 3s infinite;
        }

        /* Skeleton Loading */
        .skeleton {
            background: linear-gradient(90deg,
                rgba(42, 42, 42, 0.6) 0%,
                rgba(60, 60, 60, 0.6) 50%,
                rgba(42, 42, 42, 0.6) 100%
            );
            background-size: 200% 100%;
            animation: shimmer 1.5s ease-in-out infinite;
            border-radius: 4px;
        }
        .skeleton-text {
            height: 14px;
            margin-bottom: 8px;
        }
        .skeleton-text-sm {
            height: 10px;
            margin-bottom: 6px;
        }
        .skeleton-title {
            height: 24px;
            width: 70%;
            margin-bottom: 12px;
        }
        .skeleton-badge {
            height: 24px;
            width: 60px;
            border-radius: 6px;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }

        /* Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 100;
            align-items: center;
            justify-content: center;
        }
        .modal-overlay.active {
            display: flex;
        }
        .modal-content {
            background: #1a1d21;
            border: 1px solid #2a2e33;
            border-radius: 12px;
            max-width: 520px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.5);
        }

        /* Provider Card (for settings modal display) */
        .provider-card {
            border: 1px solid #2a2e33;
            background: #1e2227;
            padding: 1rem;
            border-radius: 8px;
        }
        .provider-card.configured {
            border-color: #0f758a;
            background: #1e2227;
        }

        /* Loading Spinner */
        .loading-spinner {
            display: inline-block;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Report Card */
        .report-card {
            opacity: 0;
            transform: translateY(20px);
            animation: slideInUp 0.4s ease forwards;
            transition: border-color 0.2s ease;
        }
        .report-card:hover {
            border-color: #0f758a;
        }
        .report-card .card-header {
            background: transparent;
        }
        .report-card .card-footer {
            background: transparent;
        }
        .report-card .card-footer button {
            transition: opacity 0.2s ease;
        }
        .report-card .card-footer button:hover {
            opacity: 0.8;
        }
        .report-card .stats-badge {
            background: #1e2227;
            border: 1px solid #2a2e33;
            padding: 0.25rem 0.625rem;
            border-radius: 4px;
            font-size: 0.6875rem;
        }
        @keyframes slideInUp {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes slideOut {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(-10px);
            }
        }

        /* Input focus enhancement */
        input:focus, select:focus, textarea:focus {
            box-shadow: 0 0 0 2px rgba(15, 117, 138, 0.15);
        }

        /* Button press feedback */
        button:active:not(:disabled) {
            transform: scale(0.98);
        }

        /* Checkbox/Radio enhancement */
        input[type="checkbox"]:checked, input[type="radio"]:checked {
            background-color: #0f758a;
        }

        /* Alerts */
        .alert {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.875rem 1.25rem;
            border: 1px solid;
            border-radius: 8px;
            margin-bottom: 1rem;
            backdrop-filter: blur(8px);
        }
        .alert-success {
            background: rgba(16, 185, 129, 0.08);
            border-color: rgba(16, 185, 129, 0.25);
            color: #34D399;
        }
        .alert-error {
            background: rgba(239, 68, 68, 0.08);
            border-color: rgba(239, 68, 68, 0.25);
            color: #F87171;
        }
        .alert-warning {
            background: rgba(245, 158, 11, 0.08);
            border-color: rgba(245, 158, 11, 0.25);
            color: #FBBF24;
        }
        .alert-info {
            background: rgba(15, 117, 138, 0.08);
            border-color: rgba(15, 117, 138, 0.25);
            color: #0f758a;
        }

        /* ==================== Report Content Styles ==================== */
        .report-content {
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
            font-size: 1.1875rem;  /* 19px - 더 읽기 쉽게 */
            line-height: 1.7;      /* 컴팩트하게 */
            color: #e5e7eb;        /* 더 밝게 */
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;
        }

        /* Headings */
        .report-content h1 {
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
            font-size: 1.75rem;
            font-weight: 700;
            color: #ffffff;
            margin: 1.25rem 0 0.625rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(15, 117, 138, 0.3);
            letter-spacing: -0.01em;
        }

        .report-content h2 {
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
            font-size: 1.375rem;
            font-weight: 600;
            color: #14b8a6;
            margin: 1rem 0 0.5rem 0;
            letter-spacing: 0;
        }

        .report-content h2::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #0f758a;
            margin-right: 12px;
            transform: rotate(45deg);
        }

        .report-content h3 {
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
            font-size: 1.125rem;
            font-weight: 600;
            color: #f3f4f6;
            margin: 0.875rem 0 0.375rem 0;
        }

        .report-content h4 {
            font-size: 0.9375rem;
            font-weight: 600;
            color: #d1d5db;
            margin: 0.75rem 0 0.25rem 0;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Paragraphs */
        .report-content p {
            margin: 0.625rem 0;
            color: #e5e7eb;
        }

        /* Lists */
        .report-content ul,
        .report-content ol {
            margin: 0.625rem 0;
            padding-left: 0;
        }

        .report-content ul {
            list-style: none;
        }

        .report-content ul li {
            position: relative;
            padding-left: 1.5rem;
            margin: 0.375rem 0;
            color: #e5e7eb;
        }

        .report-content ul li::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0.625rem;
            width: 6px;
            height: 6px;
            background: linear-gradient(135deg, #0f758a, #0d6577);
            border-radius: 1px;
            transform: rotate(45deg);
        }

        .report-content ol {
            list-style: none;
            counter-reset: item;
        }

        .report-content ol li {
            counter-increment: item;
            position: relative;
            padding-left: 2.25rem;
            margin: 0.375rem 0;
            color: #e5e7eb;
        }

        .report-content ol li::before {
            content: counter(item);
            position: absolute;
            left: 0;
            width: 1.625rem;
            height: 1.625rem;
            background: linear-gradient(135deg, #0f758a 0%, #0d6577 100%);
            color: #ffffff;
            font-size: 0.75rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
        }

        /* Nested lists */
        .report-content ul ul,
        .report-content ol ol,
        .report-content ul ol,
        .report-content ol ul {
            margin: 0.5rem 0;
        }

        .report-content ul ul li::before {
            background: #6b7280;
            width: 4px;
            height: 4px;
        }

        /* Blockquotes */
        .report-content blockquote {
            margin: 1rem 0;
            padding: 1rem 1.25rem;
            background: linear-gradient(90deg, rgba(15, 117, 138, 0.08) 0%, transparent 100%);
            border-left: 3px solid #0f758a;
            color: #e5e7eb;
            font-style: italic;
            border-radius: 0 8px 8px 0;
        }

        .report-content blockquote p {
            margin: 0;
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
        }

        /* Code blocks */
        .report-content pre {
            margin: 1rem 0;
            padding: 1rem;
            background: #16191d;
            border: 1px solid #2a2e33;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8125rem;
            line-height: 1.7;
        }

        .report-content code {
            font-family: 'JetBrains Mono', monospace;
            background: rgba(15, 117, 138, 0.12);
            color: #14a3bd;
            padding: 0.2rem 0.5rem;
            font-size: 0.85em;
            border-radius: 4px;
        }

        .report-content pre code {
            background: transparent;
            color: #e5e7eb;
            padding: 0;
        }

        /* Tables */
        .report-content table {
            width: 100%;
            margin: 1.75rem 0;
            border-collapse: collapse;
            font-size: 0.875rem;
            border-radius: 8px;
            overflow: hidden;
        }

        .report-content thead {
            background: linear-gradient(90deg, rgba(15, 117, 138, 0.15) 0%, rgba(15, 117, 138, 0.05) 100%);
        }

        .report-content th {
            padding: 0.875rem 1.25rem;
            text-align: left;
            font-weight: 600;
            color: #0f758a;
            border-bottom: 1px solid rgba(15, 117, 138, 0.3);
            text-transform: uppercase;
            font-size: 0.6875rem;
            letter-spacing: 0.08em;
        }

        .report-content td {
            padding: 0.875rem 1.25rem;
            border-bottom: 1px solid #2a2e33;
            color: #d1d5db;
        }

        .report-content tr:hover td {
            background: rgba(15, 117, 138, 0.04);
        }

        /* Strong and emphasis */
        .report-content strong {
            color: #ffffff;
            font-weight: 600;
        }

        .report-content em {
            color: #14a3bd;
            font-style: italic;
        }

        /* Links */
        .report-content a {
            color: #0f758a;
            text-decoration: none;
            border-bottom: 1px solid rgba(15, 117, 138, 0.3);
            transition: all 0.2s;
        }

        .report-content a:hover {
            border-bottom-color: #0f758a;
            color: #14a3bd;
        }

        /* Horizontal rule */
        .report-content hr {
            margin: 1.5rem 0;
            border: none;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(15, 117, 138, 0.3), transparent);
        }

        /* Key insights / highlights box */
        .report-content .highlight-box,
        .report-content .key-point {
            margin: 1.75rem 0;
            padding: 1.5rem;
            background: rgba(15, 117, 138, 0.06);
            border: 1px solid rgba(15, 117, 138, 0.15);
            border-radius: 8px;
            position: relative;
        }

        .report-content .highlight-box::before {
            content: '✦';
            position: absolute;
            top: -0.625rem;
            left: 1rem;
            background: #16191d;
            padding: 0 0.5rem;
            color: #0f758a;
        }

        /* Summary section styling */
        .report-content .summary,
        .report-content .executive-summary {
            padding: 1.75rem;
            background: linear-gradient(135deg, rgba(15, 117, 138, 0.08) 0%, rgba(13, 101, 119, 0.04) 100%);
            border-left: 3px solid #0f758a;
            border-radius: 0 8px 8px 0;
            margin: 1.75rem 0;
        }

        /* Tags / Keywords */
        .report-content .tag,
        .report-content .keyword {
            display: inline-block;
            padding: 0.3rem 0.875rem;
            background: rgba(15, 117, 138, 0.12);
            color: #0f758a;
            font-size: 0.6875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            margin: 0.25rem;
            border-radius: 4px;
        }

        /* Metric / Score displays */
        .report-content .metric {
            display: inline-flex;
            align-items: center;
            gap: 0.625rem;
            padding: 0.625rem 1.25rem;
            background: #202428;
            border: 1px solid #2a2e33;
            border-radius: 6px;
        }

        .report-content .metric-value {
            font-size: 1.625rem;
            font-weight: 700;
            color: #0f758a;
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
        }

        .report-content .metric-label {
            font-size: 0.6875rem;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Style Card Enhancement */
        .style-card {
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .style-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }
        /* Style card selection animation */
        @keyframes cardSelect {
            0% { transform: scale(0.96); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        .style-card:has(input:checked) {
            animation: cardSelect 0.3s ease-out;
        }

        /* Disabled Button Reason Overlay */
        .disabled-reason-overlay {
            position: absolute;
            bottom: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%) scale(0.95);
            background: rgba(32, 36, 40, 0.95);
            border: 1px solid rgba(15, 117, 138, 0.3);
            border-radius: 8px;
            padding: 8px 14px;
            font-size: 11px;
            color: #0f758a;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            z-index: 50;
            display: flex;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            pointer-events: none;
        }
        .disabled-reason-overlay::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: rgba(15, 117, 138, 0.3);
        }
        button.has-disabled-reason:disabled:hover .disabled-reason-overlay {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) scale(1);
        }

        /* Toast Animation */
        @keyframes toastSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .alert {
            animation: toastSlideIn 0.3s ease-out;
        }

        /* Mindmap Styles */
        #mindmap-svg {
            background: #16191d;
        }
        #mindmap-svg text {
            fill: #ffffff;
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
            font-size: 14px;
        }
        #mindmap-svg .markmap-node-circle {
            fill: #0f758a;
        }
        #mindmap-svg .markmap-link {
            stroke: rgba(15, 117, 138, 0.4);
        }
        #mindmap-svg .markmap-foreign {
            background: transparent;
        }

        /* ==================== Mobile Optimizations ==================== */

        /* Touch target sizing */
        @media (max-width: 768px) {
            /* 사이드바 숨김 */
            #sidebar {
                display: none !important;
            }

            /* 3-Panel을 탭 방식으로 전환 */
            #input-panel,
            #result-panel {
                width: 100% !important;
                min-width: 100% !important;
                max-width: 100% !important;
                display: none !important;
            }

            #input-panel.active,
            #result-panel.active {
                display: flex !important;
            }

            /* 모바일 탭 바 */
            .mobile-tab-bar {
                display: flex;
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: #16191d;
                border-top: 1px solid #2a2e33;
                z-index: 50;
            }

            .mobile-tab-bar button {
                flex: 1;
                padding: 8px;
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 2px;
                color: #9ca3af;
                font-size: 9px;
                border: none;
                background: transparent;
                min-height: 48px;
            }

            .mobile-tab-bar button.active {
                color: #0f758a;
            }

            .mobile-tab-bar button .material-symbols-outlined {
                font-size: 22px;
            }

            /* 콘텐츠 영역 하단 여백 (탭바 높이만큼) */
            #main-content {
                padding-bottom: 52px;
            }

            /* 기존 모바일 네비 숨김 (새 탭바로 대체) */
            #mobile-bottom-nav {
                display: none !important;
            }

            /* Ensure minimum 44x44px touch targets */
            button, [role="button"], label.cursor-pointer, a {
                min-height: 44px;
                min-width: 44px;
            }

            /* Style cards on mobile - keep touch-friendly */
            .style-card {
                min-height: 44px;
            }

            /* Modal as bottom sheet on mobile */
            .modal-overlay .modal-content {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                max-width: 100%;
                width: 100%;
                max-height: 90vh;
                border-radius: 20px 20px 0 0;
                animation: slideUp 0.3s ease-out;
            }

            @keyframes slideUp {
                from {
                    transform: translateY(100%);
                    opacity: 0;
                }
                to {
                    transform: translateY(0);
                    opacity: 1;
                }
            }

            /* Bottom sheet handle indicator */
            .modal-content::before {
                content: '';
                display: block;
                width: 36px;
                height: 4px;
                background: rgba(255, 255, 255, 0.2);
                border-radius: 2px;
                margin: 8px auto 4px;
            }

            /* Improve tap feedback */
            button:active, [role="button"]:active, label.cursor-pointer:active {
                opacity: 0.7;
            }

            /* Footer buttons stack on small screens */
            .report-card .card-footer .flex.items-center.gap-1 {
                flex-wrap: wrap;
                justify-content: center;
                gap: 4px;
            }

            .report-card .card-footer button {
                flex: 0 0 auto;
                padding: 8px 10px;
            }
        }

        /* 데스크톱에서는 탭 바 숨김, 패널 항상 표시 */
        @media (min-width: 769px) {
            .mobile-tab-bar {
                display: none !important;
            }

            #sidebar {
                display: flex !important;
            }

            #input-panel {
                display: flex !important;
                width: 350px !important;
                min-width: 320px !important;
                max-width: 400px !important;
            }

            #result-panel {
                display: flex !important;
                flex: 1 1 0% !important;
                min-width: 400px !important;
            }
        }

        /* Very small screens */
        @media (max-width: 375px) {
            .style-card {
                padding: 10px;
            }

            .report-card .card-footer button span:last-child {
                display: none;
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Safe area for notched devices */
        @supports (padding-bottom: env(safe-area-inset-bottom)) {
            body {
                padding-bottom: env(safe-area-inset-bottom);
            }
            .modal-content {
                padding-bottom: calc(16px + env(safe-area-inset-bottom));
            }
        }

        /* ==================== Mobile Bottom Navigation ==================== */
        .mobile-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2px;
            color: var(--text-subtle);
            font-size: 10px;
            font-weight: 500;
            transition: color 0.2s ease;
        }
        .mobile-nav-item:hover {
            color: var(--text-light);
        }
        .mobile-nav-item.active {
            color: var(--primary);
        }
        .mobile-nav-item .material-symbols-outlined {
            font-size: 22px;
        }
        .pb-safe {
            padding-bottom: env(safe-area-inset-bottom, 0px);
        }
        @media (max-width: 1023px) {
            #main-content {
                padding-bottom: calc(56px + env(safe-area-inset-bottom, 0px));
            }
        }

        /* Icon Navigation Button */
        /* Sidebar Navigation Buttons - 200px layout */
        .nav-icon-btn {
            width: 100%;
            height: 40px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0 0.75rem;
            border-radius: 8px;
            color: #9ca3af;
            transition: all 0.2s;
            cursor: pointer;
            border: none;
            background: transparent;
        }
        .nav-icon-btn:hover {
            background: #202428;
            color: #0f758a;
        }
        .nav-icon-btn.active {
            background: rgba(15, 117, 138, 0.15);
            color: #0f758a;
        }
        .nav-icon-btn .material-symbols-outlined {
            font-size: 20px;
            flex-shrink: 0;
        }
        .nav-icon-btn .nav-label {
            font-size: 13px;
            font-weight: 500;
            white-space: nowrap;
        }

        /* 패널 뷰 전환 */
        .panel-view {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        .panel-view.hidden {
            display: none;
        }

        /* 히스토리 아이템 */
        .history-item {
            background: var(--card-dark);
            border: 1px solid var(--card-border);
            border-radius: 0.75rem;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            overflow: hidden;
            min-width: 0;
        }
        .history-item:hover {
            border-color: var(--primary);
            transform: translateY(-1px);
        }
        .history-item-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            gap: 0.5rem;
        }
        .history-item-meta {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
            color: var(--text-muted);
            flex-wrap: wrap;
            min-width: 0;
            flex: 1;
        }
        .history-item-title {
            font-size: 0.9375rem;
            font-weight: 600;
            color: white;
            margin-bottom: 0.25rem;
            line-height: 1.4;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        .history-item-url {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }
        .history-item-preview {
            font-size: 0.8125rem;
            color: #9ca3af;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            word-break: break-word;
        }
        .history-delete-btn {
            padding: 0.25rem;
            color: var(--text-muted);
            transition: color 0.2s;
        }
        .history-delete-btn:hover {
            color: #ef4444;
        }

        /* Usage 차트 */
        .weekly-bar {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            gap: 0.25rem;
            height: 100%;
        }
        .weekly-bar-fill {
            width: 100%;
            max-width: 2rem;
            min-height: 4px;
            background: var(--primary);
            border-radius: 0.25rem 0.25rem 0 0;
            transition: height 0.3s;
        }
        .weekly-bar-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            flex-shrink: 0;
        }
        .weekly-bar-value {
            font-size: 0.75rem;
            color: white;
            font-weight: 500;
            flex-shrink: 0;
        }

        .style-stat-row {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .style-stat-label {
            width: 4.5rem;
            font-size: 0.75rem;
            color: white;
            flex-shrink: 0;
        }
        .style-stat-bar-bg {
            flex: 1;
            height: 0.5rem;
            background: var(--background-dark);
            border-radius: 0.25rem;
            overflow: hidden;
        }
        .style-stat-bar-fill {
            height: 100%;
            background: var(--primary);
            border-radius: 0.25rem;
            transition: width 0.3s;
        }
        .style-stat-value {
            width: 5rem;
            font-size: 0.75rem;
            color: var(--text-muted);
            text-align: right;
            flex-shrink: 0;
        }
    </style>
</head>
<body class="bg-background-dark text-text-light font-body overflow-hidden h-screen flex selection:bg-primary/30 selection:text-white">
    <!-- Skip Link for Keyboard Users -->
    <a href="#url-input" class="skip-link">메인 콘텐츠로 건너뛰기</a>

    <!-- ==================== Sidebar (200px) ==================== -->
    <aside id="sidebar" class="flex flex-col bg-background-dark flex-shrink-0 h-full z-50">
        <!-- Logo Area with Title -->
        <div class="sidebar-header">
            <div class="sidebar-logo rounded-lg bg-primary flex items-center justify-center">
                <span class="material-symbols-outlined text-white text-base">auto_awesome_motion</span>
            </div>
            <span class="sidebar-title">Insight Engine</span>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 flex flex-col gap-1 p-3">
            <button class="nav-icon-btn active" data-section="dashboard" title="Dashboard">
                <span class="material-symbols-outlined">dashboard</span>
                <span class="nav-label">Dashboard</span>
            </button>
            <button class="nav-icon-btn" data-section="history" title="History">
                <span class="material-symbols-outlined">history</span>
                <span class="nav-label">History</span>
            </button>
            <button class="nav-icon-btn" data-section="usage" title="Usage">
                <span class="material-symbols-outlined">pie_chart</span>
                <span class="nav-label">Usage</span>
            </button>
            <button id="sidebar-settings-btn" class="nav-icon-btn" title="Settings">
                <span class="material-symbols-outlined">settings</span>
                <span class="nav-label">Settings</span>
            </button>
        </nav>

        <!-- User Profile / Auth (Bottom) -->
        <div class="p-3 border-t border-border-dark">
            <button id="sidebar-auth-container" class="nav-icon-btn" title="로그인">
                <span class="material-symbols-outlined">person</span>
                <span class="nav-label">로그인</span>
            </button>
        </div>
    </aside>

    <!-- Mobile Sidebar Overlay -->
    <div id="sidebar-overlay" class="fixed inset-0 bg-black/50 z-40 hidden lg:hidden" onclick="toggleSidebar()"></div>

    <!-- ==================== Main Content Area (3-Column Layout) ==================== -->
    <div class="main-container">
        <!-- Top Bar (Header) -->
        <header class="h-14 flex items-center justify-between px-6 border-b border-border-dark bg-background-dark flex-shrink-0">
            <!-- Left: Version Badge -->
            <div class="flex items-center gap-3">
                <span class="px-2 py-0.5 rounded text-[10px] font-bold bg-surface-dark text-primary">Beta v2.5</span>
            </div>

            <!-- Right: Usage Display + Provider Badge + Actions -->
            <div class="flex items-center gap-3">
                <!-- Usage Display -->
                <div id="usage-display-header" class="flex items-center gap-2 px-3 py-1.5 bg-surface-dark rounded-lg text-xs">
                    <span class="material-symbols-outlined text-primary text-sm" aria-hidden="true">bolt</span>
                    <span class="text-text-secondary">
                        <span id="header-usage-count">-</span> / <span id="header-usage-limit">-</span>
                    </span>
                </div>

                <!-- AI Provider Badge -->
                <div id="provider-badge-header" class="flex items-center gap-2 px-3 py-1.5 bg-surface-dark rounded-lg cursor-pointer hover:bg-bg-elevated transition-colors">
                    <span class="text-primary text-[10px] font-bold">AI</span>
                    <span class="text-xs text-text-secondary" id="current-provider-label">미설정</span>
                </div>

                <!-- Theme Toggle Button -->
                <button id="theme-toggle-btn" class="relative flex items-center justify-center cursor-pointer text-text-secondary hover:text-primary transition-colors p-2 rounded-lg hover:bg-surface-dark group" aria-label="테마 전환">
                    <span class="material-symbols-outlined text-lg" aria-hidden="true">contrast</span>
                    <span class="theme-tooltip absolute top-full mt-1 px-2 py-1 bg-surface-dark text-xs text-text-secondary rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none z-50">시스템 설정</span>
                </button>

                <!-- Settings Button -->
                <button id="settings-btn" class="flex items-center gap-1.5 cursor-pointer text-text-secondary hover:text-primary transition-colors p-2 rounded-lg hover:bg-surface-dark" aria-label="설정">
                    <span class="material-symbols-outlined text-lg" aria-hidden="true">settings</span>
                </button>

                <!-- Auth Container -->
                <div id="auth-container" class="flex items-center"></div>
            </div>
        </header>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settings-modal" role="dialog" aria-modal="true" aria-labelledby="settings-modal-title">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h2 id="settings-modal-title" class="text-xl font-bold flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary" aria-hidden="true">settings</span>
                    설정
                </h2>
                <button id="modal-close" class="p-2 hover:bg-white/10 text-text-subtle hover:text-white transition-colors rounded-lg" aria-label="설정 닫기">
                    <span class="material-symbols-outlined" aria-hidden="true">close</span>
                </button>
            </div>

            <!-- AI Services Section -->
            <div class="mb-6">
                <h3 class="font-bold mb-3 flex items-center gap-2 text-sm">
                    <span class="material-symbols-outlined text-primary">smart_toy</span>
                    AI 서비스
                </h3>
                <div id="provider-list" class="space-y-3 max-h-[40vh] overflow-y-auto">
                    <!-- Provider list will be dynamically generated -->
                </div>
            </div>

            <!-- Cache Management Section -->
            <div class="pt-4 border-t border-border-dark/50">
                <h3 class="font-bold mb-3 flex items-center gap-2 text-sm">
                    <span class="material-symbols-outlined text-orange-400">cached</span>
                    캐시 관리
                </h3>
                <p class="text-xs text-text-subtle mb-3 font-body">
                    저장된 자막/댓글 캐시를 삭제합니다. 같은 영상을 새로 분석하려면 캐시를 삭제하세요.
                </p>
                <button type="button" id="clear-cache-btn" class="w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-red-500/10 border border-red-500/30 text-red-400 hover:bg-red-500/20 hover:border-red-500/50 transition-all rounded-lg text-sm font-medium">
                    <span class="material-symbols-outlined text-base">delete</span>
                    <span>전체 캐시 삭제</span>
                </button>
            </div>

            <div class="flex justify-end gap-3 mt-6 pt-4 border-t border-border-dark/50">
                <button id="modal-cancel" class="px-6 py-2 text-sm font-bold bg-primary text-black hover:bg-white transition-colors rounded-lg">닫기</button>
            </div>
        </div>
    </div>

    <!-- Custom Style Modal -->
    <div class="modal-overlay" id="custom-style-modal" role="dialog" aria-modal="true" aria-labelledby="custom-style-modal-heading">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h2 id="custom-style-modal-heading" class="text-xl font-bold flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary" aria-hidden="true">edit_note</span>
                    <span id="custom-style-modal-title">새 스타일 만들기</span>
                </h2>
                <button id="custom-style-modal-close" class="p-2 hover:bg-white/10 text-text-subtle hover:text-white transition-colors" aria-label="스타일 편집 닫기">
                    <span class="material-symbols-outlined" aria-hidden="true">close</span>
                </button>
            </div>

            <div class="space-y-4">
                <!-- Style Name -->
                <div>
                    <label class="block text-xs font-mono text-text-subtle mb-2 uppercase">스타일 이름</label>
                    <input type="text" id="custom-style-name" maxlength="20" placeholder="예: 내 분석 스타일" class="w-full bg-black border border-border-dark text-white p-3 focus:border-primary focus:outline-none"/>
                </div>

                <!-- Icon Selection -->
                <div>
                    <label class="block text-xs font-mono text-text-subtle mb-2 uppercase">아이콘 선택</label>
                    <div class="grid grid-cols-5 gap-2" id="icon-selection">
                        <label class="cursor-pointer">
                            <input type="radio" name="custom-icon" value="edit_note" checked class="peer sr-only"/>
                            <div class="border border-border-dark bg-black p-3 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-gray-500 transition-all">
                                <span class="material-symbols-outlined text-text-subtle peer-checked:text-primary">edit_note</span>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="radio" name="custom-icon" value="star" class="peer sr-only"/>
                            <div class="border border-border-dark bg-black p-3 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-gray-500 transition-all">
                                <span class="material-symbols-outlined text-text-subtle peer-checked:text-primary">star</span>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="radio" name="custom-icon" value="bookmark" class="peer sr-only"/>
                            <div class="border border-border-dark bg-black p-3 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-gray-500 transition-all">
                                <span class="material-symbols-outlined text-text-subtle peer-checked:text-primary">bookmark</span>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="radio" name="custom-icon" value="psychology" class="peer sr-only"/>
                            <div class="border border-border-dark bg-black p-3 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-gray-500 transition-all">
                                <span class="material-symbols-outlined text-text-subtle peer-checked:text-primary">psychology</span>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="radio" name="custom-icon" value="rocket_launch" class="peer sr-only"/>
                            <div class="border border-border-dark bg-black p-3 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-gray-500 transition-all">
                                <span class="material-symbols-outlined text-text-subtle peer-checked:text-primary">rocket_launch</span>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Prompt -->
                <div>
                    <label class="block text-xs font-mono text-text-subtle mb-2 uppercase">프롬프트</label>
                    <textarea id="custom-style-prompt" maxlength="2000" rows="8" placeholder="AI에게 전달할 지시사항을 작성하세요.&#10;&#10;예:&#10;당신은 마케팅 전문가입니다.&#10;아래 영상의 내용을 분석하여 마케팅 인사이트를 도출해주세요.&#10;- 타겟 고객층&#10;- 핵심 메시지&#10;- 활용 가능한 채널" class="w-full bg-black border border-border-dark text-white p-3 focus:border-primary focus:outline-none resize-none font-mono text-sm"></textarea>
                    <div class="text-right text-xs text-text-subtle mt-1">
                        <span id="prompt-char-count">0</span>/2000자
                    </div>
                </div>
            </div>

            <div class="flex justify-between gap-3 mt-6 pt-4 border-t border-border-dark/50">
                <button id="custom-style-delete" class="px-4 py-2 text-sm font-bold text-red-500 hover:text-red-400 hover:bg-red-500/10 transition-colors hidden">삭제</button>
                <div class="flex gap-3 ml-auto">
                    <button id="custom-style-cancel" class="px-4 py-2 text-sm font-bold text-text-subtle hover:text-white transition-colors">취소</button>
                    <button id="custom-style-save" class="px-6 py-2 text-sm font-bold bg-primary text-black hover:bg-white transition-colors">저장</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal-overlay" id="auth-modal" role="dialog" aria-modal="true" aria-labelledby="auth-modal-title">
        <div class="modal-content p-6" style="max-width: 400px;">
            <div class="flex items-center justify-between mb-6">
                <h2 id="auth-modal-title" class="text-xl font-bold flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary" aria-hidden="true">person</span>
                    로그인 / 회원가입
                </h2>
                <button id="auth-modal-close" class="p-2 hover:bg-white/10 text-text-subtle hover:text-white transition-colors rounded-lg" aria-label="로그인 창 닫기">
                    <span class="material-symbols-outlined" aria-hidden="true">close</span>
                </button>
            </div>

            <!-- Tabs -->
            <div class="flex border-b border-border-dark mb-6">
                <button id="auth-login-tab" class="flex-1 py-3 text-sm font-medium border-b-2 border-primary text-primary transition-colors">
                    로그인
                </button>
                <button id="auth-signup-tab" class="flex-1 py-3 text-sm font-medium border-b-2 border-transparent text-text-subtle hover:text-white transition-colors">
                    회원가입
                </button>
            </div>

            <!-- Login Form -->
            <div id="auth-login-form" class="space-y-4">
                <div>
                    <label class="block text-xs text-text-subtle mb-2">이메일</label>
                    <input type="email" id="login-email" class="w-full bg-background-dark border border-border-dark rounded-lg px-4 py-3 text-sm text-warm-white focus:border-primary focus:outline-none transition-colors" placeholder="your@email.com">
                </div>
                <div>
                    <label class="block text-xs text-text-subtle mb-2">비밀번호</label>
                    <input type="password" id="login-password" class="w-full bg-background-dark border border-border-dark rounded-lg px-4 py-3 text-sm text-warm-white focus:border-primary focus:outline-none transition-colors" placeholder="••••••••">
                </div>
                <button id="auth-login-submit" class="w-full bg-gradient-to-r from-primary to-primary-glow text-background-dark font-semibold py-3 rounded-lg hover:opacity-90 transition-opacity">
                    로그인
                </button>
                <button id="show-reset-password" class="w-full text-xs text-text-subtle hover:text-primary transition-colors py-2">
                    비밀번호를 잊으셨나요?
                </button>

                <!-- 소셜 로그인 구분선 -->
                <div class="flex items-center gap-3 my-4">
                    <div class="flex-1 h-px bg-border-dark"></div>
                    <span class="text-xs text-text-subtle">또는</span>
                    <div class="flex-1 h-px bg-border-dark"></div>
                </div>

                <!-- 소셜 로그인 버튼 -->
                <button id="google-login-btn" class="w-full flex items-center justify-center gap-2 bg-white text-gray-800 font-medium py-3 rounded-lg hover:bg-gray-100 transition-colors">
                    <svg class="w-5 h-5" viewBox="0 0 24 24">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    Google로 로그인
                </button>
            </div>

            <!-- Signup Form -->
            <div id="auth-signup-form" class="space-y-4 hidden">
                <div>
                    <label class="block text-xs text-text-subtle mb-2">이메일</label>
                    <input type="email" id="signup-email" class="w-full bg-background-dark border border-border-dark rounded-lg px-4 py-3 text-sm text-warm-white focus:border-primary focus:outline-none transition-colors" placeholder="your@email.com">
                </div>
                <div>
                    <label class="block text-xs text-text-subtle mb-2">비밀번호</label>
                    <input type="password" id="signup-password" class="w-full bg-background-dark border border-border-dark rounded-lg px-4 py-3 text-sm text-warm-white focus:border-primary focus:outline-none transition-colors" placeholder="6자 이상">
                </div>
                <div>
                    <label class="block text-xs text-text-subtle mb-2">비밀번호 확인</label>
                    <input type="password" id="signup-confirm-password" class="w-full bg-background-dark border border-border-dark rounded-lg px-4 py-3 text-sm text-warm-white focus:border-primary focus:outline-none transition-colors" placeholder="비밀번호 재입력">
                </div>
                <button id="auth-signup-submit" class="w-full bg-gradient-to-r from-primary to-primary-glow text-background-dark font-semibold py-3 rounded-lg hover:opacity-90 transition-opacity">
                    회원가입
                </button>
            </div>

            <!-- Reset Password Form -->
            <div id="auth-reset-form" class="space-y-4 hidden">
                <p class="text-sm text-text-subtle mb-2">
                    가입한 이메일 주소를 입력하시면 비밀번호 재설정 링크를 보내드립니다.
                </p>
                <div>
                    <label class="block text-xs text-text-subtle mb-2">이메일</label>
                    <input type="email" id="reset-email" class="w-full bg-background-dark border border-border-dark rounded-lg px-4 py-3 text-sm text-warm-white focus:border-primary focus:outline-none transition-colors" placeholder="your@email.com">
                </div>
                <button id="auth-reset-submit" class="w-full bg-gradient-to-r from-primary to-primary-glow text-background-dark font-semibold py-3 rounded-lg hover:opacity-90 transition-opacity">
                    재설정 이메일 발송
                </button>
                <button id="back-to-login" class="w-full text-xs text-text-subtle hover:text-primary transition-colors py-2">
                    ← 로그인으로 돌아가기
                </button>
            </div>

            <p class="text-xs text-text-subtle/60 text-center mt-4">
                Supabase 인증 사용
            </p>
        </div>
    </div>

    <!-- Mindmap Modal -->
    <div class="modal-overlay" id="mindmap-modal" role="dialog" aria-modal="true" aria-labelledby="mindmap-modal-title">
        <div class="modal-content" style="max-width: 95vw; max-height: 95vh; width: 1200px;">
            <div class="flex items-center justify-between p-4 border-b border-border-dark/50">
                <h2 id="mindmap-modal-title" class="text-lg font-bold flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary" aria-hidden="true">account_tree</span>
                    <span id="mindmap-title">마인드맵</span>
                </h2>
                <div class="flex items-center gap-2">
                    <button id="mindmap-zoom-in" class="p-2 hover:bg-white/10 text-text-subtle hover:text-white transition-colors rounded" title="확대">
                        <span class="material-symbols-outlined text-sm">zoom_in</span>
                    </button>
                    <button id="mindmap-zoom-out" class="p-2 hover:bg-white/10 text-text-subtle hover:text-white transition-colors rounded" title="축소">
                        <span class="material-symbols-outlined text-sm">zoom_out</span>
                    </button>
                    <button id="mindmap-fit" class="p-2 hover:bg-white/10 text-text-subtle hover:text-white transition-colors rounded" title="화면에 맞추기">
                        <span class="material-symbols-outlined text-sm">fit_screen</span>
                    </button>
                    <div class="h-5 w-px bg-border-dark mx-1"></div>
                    <button id="mindmap-close" class="p-2 hover:bg-white/10 text-text-subtle hover:text-white transition-colors rounded">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
            </div>
            <div id="mindmap-container" class="relative bg-black" style="height: calc(95vh - 120px);">
                <!-- Loading state -->
                <div id="mindmap-loading" class="absolute inset-0 flex items-center justify-center">
                    <div class="text-center">
                        <span class="material-symbols-outlined text-4xl text-primary loading-spinner">progress_activity</span>
                        <p class="text-text-subtle mt-3 text-sm">마인드맵 생성 중...</p>
                    </div>
                </div>
                <!-- SVG will be rendered here -->
                <svg id="mindmap-svg" class="w-full h-full"></svg>
            </div>
            <div class="p-3 border-t border-border-dark/50 flex items-center justify-between text-xs text-text-subtle">
                <span id="mindmap-stats"></span>
                <span class="text-text-subtle/50">드래그: 이동 | 스크롤: 확대/축소</span>
            </div>
        </div>
    </div>

    <!-- Prompt Modal (AI 입력 프롬프트 보기) -->
    <div class="modal-overlay" id="prompt-modal">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh;">
            <div class="flex items-center justify-between p-4 border-b border-border-dark/50">
                <h2 class="text-lg font-bold flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary">code</span>
                    <span>AI 입력 프롬프트</span>
                </h2>
                <div class="flex items-center gap-2">
                    <button id="prompt-copy-btn" class="inline-flex items-center gap-1.5 text-xs text-text-subtle hover:text-primary px-3 py-1.5 hover:bg-primary/10 transition-colors rounded-lg" title="복사">
                        <span class="material-symbols-outlined text-sm">content_copy</span>
                        <span>복사</span>
                    </button>
                    <button id="prompt-close" class="p-2 hover:bg-white/10 text-text-subtle hover:text-white transition-colors rounded">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
            </div>
            <div id="prompt-content" class="p-6 overflow-y-auto font-mono text-sm text-gray-300 leading-relaxed whitespace-pre-wrap bg-black/30" style="max-height: calc(90vh - 120px);">
                <!-- 프롬프트 내용이 여기에 표시됩니다 -->
            </div>
            <div class="p-3 border-t border-border-dark/50 flex items-center justify-between text-xs text-text-subtle">
                <span id="prompt-stats"></span>
                <span class="text-text-subtle/50">스타일 프롬프트 + 자막 + 댓글</span>
            </div>
        </div>
    </div>

    <!-- Onboarding Modal -->
    <div class="modal-overlay" id="onboarding-modal">
        <div class="modal-content p-6">
            <div class="text-center mb-8">
                <div class="w-20 h-20 mx-auto mb-4 bg-gradient-to-br from-primary to-purple-600 flex items-center justify-center rounded-2xl">
                    <span class="material-symbols-outlined text-white text-4xl">smart_display</span>
                </div>
                <h2 class="text-2xl font-bold mb-2">환영합니다!</h2>
                <p class="text-text-subtle font-body">YouTube 영상을 AI로 분석하여<br>요약, 인사이트, 아이디어를 도출합니다.</p>
            </div>
            <div class="mb-6">
                <div id="onboarding-providers" class="space-y-3 max-h-[40vh] overflow-y-auto">
                    <!-- Available services will be dynamically generated -->
                </div>
            </div>
            <button id="onboarding-save" class="w-full bg-primary text-black font-bold py-4 text-lg uppercase tracking-wider hover:bg-white transition-colors flex items-center justify-center gap-2 rounded-xl">
                <span class="material-symbols-outlined">check</span>
                시작하기
            </button>
            <button id="onboarding-skip" class="w-full mt-3 bg-transparent border border-border-dark text-text-subtle font-medium py-3 text-sm hover:border-primary/50 hover:text-white transition-colors flex items-center justify-center gap-2 rounded-xl hidden">
                <span class="material-symbols-outlined text-sm">visibility</span>
                먼저 둘러보기
            </button>
        </div>
    </div>

        <!-- Main Content Area - 3-Column Layout (Input 350px + Result flex-1) -->
        <main id="main-content" class="content-area">
                <!-- ==================== 입력 패널 (350px) ==================== -->
                <div id="input-panel" class="flex flex-col bg-background-dark">
                    <!-- Alert Container -->
                    <div id="alert-container" class="px-4 pt-4"></div>

                    <!-- ===== URL 입력 섹션 ===== -->
                    <div class="p-4 border-b border-border-dark">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="material-symbols-outlined text-primary text-sm">link</span>
                            <span class="text-sm font-medium text-white">URL 입력</span>
                        </div>
                        <!-- URL 입력 필드 -->
                        <div class="flex gap-2">
                            <div class="relative flex-1">
                                <input type="text" id="url-input"
                                       class="w-full bg-surface-dark border border-border-dark rounded-lg px-3 py-2.5 pl-10 text-sm text-white placeholder-text-secondary focus:border-primary focus:outline-none transition-colors"
                                       placeholder="https://www.youtube.com/watch?v=...">
                                <div class="absolute left-3 top-1/2 -translate-y-1/2 text-primary/60">
                                    <span class="material-symbols-outlined text-lg">add_link</span>
                                </div>
                            </div>
                            <button id="start-btn" class="px-3 py-2.5 bg-primary hover:bg-primary-hover text-white rounded-lg transition-colors flex items-center gap-1.5" title="URL 추가">
                                <span class="material-symbols-outlined text-lg">add</span>
                                <span class="text-sm font-medium hidden sm:inline">추가</span>
                            </button>
                        </div>
                        <!-- URL 목록 -->
                        <div id="url-list-container" class="mt-3 space-y-1.5 max-h-[150px] overflow-y-auto"></div>
                        <!-- URL 개수 및 AI 자동 분석 -->
                        <div class="flex items-center justify-between mt-3">
                            <span class="text-xs text-text-secondary flex items-center gap-1.5">
                                <span class="material-symbols-outlined text-xs text-primary/60">playlist_add</span>
                                <span id="url-count">0</span>/10 URLs
                            </span>
                            <button id="ai-analyze-btn" class="flex items-center gap-1.5 text-xs text-purple-400 hover:text-purple-300 transition-colors" title="AI가 제목을 분석하여 최적 세팅 후 바로 분석합니다">
                                <span class="material-symbols-outlined text-sm">auto_awesome</span>
                                <span>AI 자동 분석</span>
                            </button>
                        </div>
                    </div>

                    <!-- ===== AI 모델 섹션 ===== -->
                    <div class="p-4 border-b border-border-dark">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="material-symbols-outlined text-primary text-sm">psychology</span>
                            <span class="text-sm font-medium text-white">AI 모델</span>
                        </div>
                        <div class="space-y-2">
                            <div class="relative">
                                <select id="provider" class="w-full bg-surface-dark border border-border-dark rounded-lg px-3 py-2.5 text-sm text-white cursor-pointer appearance-none focus:border-primary focus:outline-none transition-colors">
                                    <option value="">서비스 선택</option>
                                </select>
                                <span class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-text-secondary text-lg">expand_more</span>
                            </div>
                            <div class="relative">
                                <select id="model" class="w-full bg-surface-dark border border-border-dark rounded-lg px-3 py-2.5 text-sm text-white cursor-pointer appearance-none focus:border-primary focus:outline-none transition-colors">
                                    <option value="">모델 선택</option>
                                </select>
                                <span class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-text-secondary text-lg">expand_more</span>
                            </div>
                        </div>
                    </div>

                    <!-- ===== 스타일 섹션 ===== -->
                    <div class="p-4 border-b border-border-dark flex-1 overflow-y-auto">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-primary text-sm">style</span>
                                <span class="text-sm font-medium text-white">스타일</span>
                            </div>
                        </div>

                        <!-- 기본 스타일 -->
                        <div class="mb-4">
                            <span class="text-[10px] font-semibold text-text-secondary uppercase tracking-wider mb-2 block">기본</span>
                            <div class="flex flex-wrap gap-1.5" id="style-options">
                                <label class="cursor-pointer" title="블로그 포스트 형태로 작성합니다">
                                    <input checked name="style" type="radio" value="blog" class="peer sr-only"/>
                                    <div class="px-3 py-2 rounded-lg bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 text-xs font-medium transition-all flex items-center gap-1.5">
                                        <span class="material-symbols-outlined text-base">edit_note</span>
                                        Blog
                                    </div>
                                </label>
                                <label class="cursor-pointer" title="핵심 내용만 간결하게 요약합니다">
                                    <input name="style" type="radio" value="summary" class="peer sr-only"/>
                                    <div class="px-3 py-2 rounded-lg bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 text-xs font-medium transition-all flex items-center gap-1.5">
                                        <span class="material-symbols-outlined text-base">description</span>
                                        Summary
                                    </div>
                                </label>
                                <label class="cursor-pointer" title="상세하고 풍부하게 작성합니다">
                                    <input name="style" type="radio" value="detailed" class="peer sr-only"/>
                                    <div class="px-3 py-2 rounded-lg bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 text-xs font-medium transition-all flex items-center gap-1.5">
                                        <span class="material-symbols-outlined text-base">article</span>
                                        Detail
                                    </div>
                                </label>
                                <label class="cursor-pointer" title="누구나 이해하기 쉬운 말로 풀어서 설명합니다">
                                    <input name="style" type="radio" value="easy" class="peer sr-only"/>
                                    <div class="px-3 py-2 rounded-lg bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 text-xs font-medium transition-all flex items-center gap-1.5">
                                        <span class="material-symbols-outlined text-base">forum</span>
                                        Easy
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- 분석 스타일 -->
                        <div class="mb-4">
                            <span class="text-[10px] font-semibold text-text-secondary uppercase tracking-wider mb-2 block">분석</span>
                            <div class="flex flex-wrap gap-1.5" id="style-options-analysis">
                                <label class="cursor-pointer" title="영상에서 언급된 니즈와 추천 아이템을 분석합니다">
                                    <input name="style" type="radio" value="needs" class="peer sr-only"/>
                                    <div class="px-3 py-2 rounded-lg bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 text-xs font-medium transition-all flex items-center gap-1.5">
                                        <span class="material-symbols-outlined text-base">lightbulb</span>
                                        Ideas
                                    </div>
                                </label>
                                <label class="cursor-pointer" title="질문과 답변 형식으로 정리합니다">
                                    <input name="style" type="radio" value="qna" class="peer sr-only"/>
                                    <div class="px-3 py-2 rounded-lg bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 text-xs font-medium transition-all flex items-center gap-1.5">
                                        <span class="material-symbols-outlined text-base">quiz</span>
                                        Q&A
                                    </div>
                                </label>
                                <label class="cursor-pointer" title="인포그래픽 제작에 적합한 핵심 데이터를 추출합니다">
                                    <input name="style" type="radio" value="infographic" class="peer sr-only"/>
                                    <div class="px-3 py-2 rounded-lg bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 text-xs font-medium transition-all flex items-center gap-1.5">
                                        <span class="material-symbols-outlined text-base">insert_chart</span>
                                        Info
                                    </div>
                                </label>
                                <label class="cursor-pointer" title="여러 요소를 비교 분석하여 정리합니다">
                                    <input name="style" type="radio" value="compare" class="peer sr-only"/>
                                    <div class="px-3 py-2 rounded-lg bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 text-xs font-medium transition-all flex items-center gap-1.5">
                                        <span class="material-symbols-outlined text-base">compare</span>
                                        Compare
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- 콘텐츠 스타일 -->
                        <div class="mb-4">
                            <span class="text-[10px] font-semibold text-text-secondary uppercase tracking-wider mb-2 block">콘텐츠</span>
                            <div class="flex flex-wrap gap-1.5" id="style-options-content">
                                <label class="cursor-pointer" title="뉴스 기사 형태로 객관적으로 작성합니다">
                                    <input name="style" type="radio" value="news" class="peer sr-only"/>
                                    <div class="px-3 py-2 rounded-lg bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 text-xs font-medium transition-all flex items-center gap-1.5">
                                        <span class="material-symbols-outlined text-base">newspaper</span>
                                        News
                                    </div>
                                </label>
                                <label class="cursor-pointer" title="영상 대본/스크립트 형태로 재구성합니다">
                                    <input name="style" type="radio" value="script" class="peer sr-only"/>
                                    <div class="px-3 py-2 rounded-lg bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 text-xs font-medium transition-all flex items-center gap-1.5">
                                        <span class="material-symbols-outlined text-base">movie</span>
                                        Script
                                    </div>
                                </label>
                                <label class="cursor-pointer" title="SNS 포스팅에 적합한 짧고 임팩트 있는 글을 작성합니다">
                                    <input name="style" type="radio" value="sns" class="peer sr-only"/>
                                    <div class="px-3 py-2 rounded-lg bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 text-xs font-medium transition-all flex items-center gap-1.5">
                                        <span class="material-symbols-outlined text-base">share</span>
                                        SNS
                                    </div>
                                </label>
                                <label class="cursor-pointer" title="SEO에 최적화된 형태로 작성합니다">
                                    <input name="style" type="radio" value="seo" class="peer sr-only"/>
                                    <div class="px-3 py-2 rounded-lg bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 text-xs font-medium transition-all flex items-center gap-1.5">
                                        <span class="material-symbols-outlined text-base">search</span>
                                        SEO
                                    </div>
                                </label>
                                <!-- Custom Button -->
                                <button id="add-custom-style-btn" class="px-3 py-2 rounded-lg border border-dashed border-primary/40 text-primary hover:bg-primary/10 text-xs font-medium transition-all flex items-center gap-1.5">
                                    <span class="material-symbols-outlined text-base">add</span>
                                    Custom
                                </button>
                            </div>
                        </div>

                        <!-- Custom Styles Section -->
                        <div id="custom-styles-section" class="hidden mb-4">
                            <span class="text-[10px] font-semibold text-text-secondary uppercase tracking-wider mb-2 block">My Styles</span>
                            <div id="custom-styles-grid" class="flex flex-wrap gap-1.5">
                                <!-- Custom styles will be inserted here -->
                            </div>
                        </div>

                        <!-- AI Style Generate Button -->
                        <button id="generate-style-btn" class="w-full px-3 py-2.5 rounded-lg border border-border-dark hover:border-primary bg-transparent text-text-secondary hover:text-primary text-xs font-medium transition-colors flex items-center justify-center gap-1.5" title="AI가 영상에 맞는 맞춤 프롬프트를 생성합니다">
                            <span class="material-symbols-outlined text-base">auto_awesome</span>
                            <span>AI 스타일 생성</span>
                        </button>
                    </div>

                    <!-- ===== 고급 옵션 (접힘) ===== -->
                    <div class="border-b border-border-dark">
                        <button id="advanced-options-toggle" class="w-full p-4 flex items-center justify-between text-text-secondary hover:text-white transition-colors">
                            <div class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-sm">tune</span>
                                <span class="text-sm">고급 옵션</span>
                            </div>
                            <span class="material-symbols-outlined text-sm transition-transform" id="advanced-options-arrow">expand_more</span>
                        </button>
                        <div id="advanced-options-panel" class="hidden p-4 pt-0 space-y-4">
                            <!-- 길이 -->
                            <div>
                                <label class="block text-[10px] font-semibold text-text-secondary mb-2 uppercase tracking-wider">길이</label>
                                <div class="flex gap-2">
                                    <label class="flex-1 cursor-pointer">
                                        <input type="radio" name="length" value="short" class="peer sr-only"/>
                                        <div class="border border-border-dark bg-surface-dark rounded-lg p-2 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-primary/50 transition-all">
                                            <span class="text-xs font-medium text-text-secondary peer-checked:text-white">짧게</span>
                                        </div>
                                    </label>
                                    <label class="flex-1 cursor-pointer">
                                        <input type="radio" name="length" value="medium" checked class="peer sr-only"/>
                                        <div class="border border-border-dark bg-surface-dark rounded-lg p-2 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-primary/50 transition-all">
                                            <span class="text-xs font-medium text-text-secondary peer-checked:text-white">보통</span>
                                        </div>
                                    </label>
                                    <label class="flex-1 cursor-pointer">
                                        <input type="radio" name="length" value="long" class="peer sr-only"/>
                                        <div class="border border-border-dark bg-surface-dark rounded-lg p-2 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-primary/50 transition-all">
                                            <span class="text-xs font-medium text-text-secondary peer-checked:text-white">상세</span>
                                        </div>
                                    </label>
                                </div>
                            </div>
                            <!-- 톤 -->
                            <div>
                                <label class="block text-[10px] font-semibold text-text-secondary mb-2 uppercase tracking-wider">톤</label>
                                <div class="flex gap-2">
                                    <label class="flex-1 cursor-pointer">
                                        <input type="radio" name="tone" value="professional" checked class="peer sr-only"/>
                                        <div class="border border-border-dark bg-surface-dark rounded-lg p-2 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-primary/50 transition-all">
                                            <span class="text-xs font-medium text-text-secondary peer-checked:text-white">전문적</span>
                                        </div>
                                    </label>
                                    <label class="flex-1 cursor-pointer">
                                        <input type="radio" name="tone" value="friendly" class="peer sr-only"/>
                                        <div class="border border-border-dark bg-surface-dark rounded-lg p-2 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-primary/50 transition-all">
                                            <span class="text-xs font-medium text-text-secondary peer-checked:text-white">친근</span>
                                        </div>
                                    </label>
                                    <label class="flex-1 cursor-pointer">
                                        <input type="radio" name="tone" value="humorous" class="peer sr-only"/>
                                        <div class="border border-border-dark bg-surface-dark rounded-lg p-2 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-primary/50 transition-all">
                                            <span class="text-xs font-medium text-text-secondary peer-checked:text-white">유머</span>
                                        </div>
                                    </label>
                                </div>
                            </div>
                            <!-- 언어 & 이모지 -->
                            <div class="flex gap-3">
                                <div class="flex-1">
                                    <label class="block text-[10px] font-semibold text-text-secondary mb-2 uppercase tracking-wider">언어</label>
                                    <select id="language-select" class="w-full bg-surface-dark border border-border-dark text-white text-xs p-2 rounded-lg focus:border-primary focus:outline-none transition-colors">
                                        <option value="ko">한국어</option>
                                        <option value="en">English</option>
                                        <option value="ja">日本語</option>
                                    </select>
                                </div>
                                <div class="flex-1">
                                    <label class="block text-[10px] font-semibold text-text-secondary mb-2 uppercase tracking-wider">이모지</label>
                                    <label class="flex items-center gap-2 cursor-pointer p-2 border border-border-dark bg-surface-dark rounded-lg hover:border-primary/50 transition-all">
                                        <input type="checkbox" id="emoji-checkbox" class="w-4 h-4 accent-primary"/>
                                        <span class="text-xs text-text-secondary">사용</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ===== 생성 버튼 (하단 고정) ===== -->
                    <div class="p-4 mt-auto">
                        <button id="run-analysis-btn" class="relative w-full bg-primary hover:bg-primary-hover text-white font-semibold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2">
                            <span class="material-symbols-outlined text-xl" id="run-icon">auto_awesome</span>
                            <span id="run-text">콘텐츠 생성</span>
                            <span id="pending-badge" class="hidden absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold min-w-[20px] h-5 flex items-center justify-center rounded-full px-1.5 shadow-lg animate-pulse">0</span>
                        </button>
                    </div>
                </div>

                <!-- ==================== 결과 패널 (flex-1) ==================== -->
                <div id="result-panel" class="flex flex-col bg-background-dark">
                    <!-- ===== Dashboard View (기존) ===== -->
                    <div id="dashboard-view" class="panel-view">
                        <!-- 헤더 -->
                        <div class="p-4 border-b border-border-dark flex-shrink-0">
                            <div class="flex items-center justify-between">
                                <h2 class="text-lg font-semibold text-white">결과</h2>
                                <div id="live-indicator" class="hidden flex items-center gap-2 text-xs text-primary">
                                    <span class="w-2 h-2 bg-primary rounded-full animate-pulse"></span>
                                    <span>LIVE</span>
                                </div>
                            </div>
                        </div>
                        <!-- 리포트 스트림 -->
                        <div id="report-stream" class="flex-1 p-4 space-y-2 overflow-y-auto"></div>
                        <!-- Empty State -->
                        <div id="empty-state" class="flex-1 flex flex-col items-center justify-center p-8 text-center">
                            <span class="material-symbols-outlined text-6xl text-text-muted mb-4">article</span>
                            <p class="text-text-muted text-lg mb-2">생성된 콘텐츠가 없습니다</p>
                            <p class="text-text-muted text-sm">왼쪽에서 URL을 입력하고 콘텐츠를 생성하세요</p>
                        </div>
                    </div>

                    <!-- ===== History View (신규) ===== -->
                    <div id="history-view" class="panel-view hidden overflow-hidden">
                        <!-- 헤더 -->
                        <div class="p-4 border-b border-border-dark flex-shrink-0">
                            <div class="flex items-center justify-between">
                                <h2 class="text-lg font-semibold text-white flex items-center gap-2">
                                    <span class="material-symbols-outlined">history</span>
                                    히스토리
                                </h2>
                                <button id="clear-all-history-btn" class="text-xs text-text-muted hover:text-red-400 transition-colors flex items-center gap-1">
                                    <span class="material-symbols-outlined text-sm">delete</span>
                                    전체 삭제
                                </button>
                            </div>
                        </div>
                        <!-- 히스토리 목록 -->
                        <div id="history-list" class="flex-1 p-4 space-y-3 overflow-y-auto overflow-x-hidden"></div>
                        <!-- Empty State -->
                        <div id="history-empty-state" class="flex-1 flex flex-col items-center justify-center p-8 text-center">
                            <span class="material-symbols-outlined text-6xl text-text-muted mb-4">history</span>
                            <p class="text-text-muted text-lg mb-2">히스토리가 없습니다</p>
                            <p class="text-text-muted text-sm">콘텐츠를 생성하면 여기에 기록됩니다</p>
                        </div>
                        <!-- 푸터 -->
                        <div id="history-footer" class="p-3 border-t border-border-dark text-xs text-text-muted text-center hidden">
                            총 <span id="history-count">0</span>개 항목 • 최대 50개 저장
                        </div>
                    </div>

                    <!-- ===== Usage View (신규) ===== -->
                    <div id="usage-view" class="panel-view hidden">
                        <!-- 헤더 -->
                        <div class="p-4 border-b border-border-dark flex-shrink-0">
                            <h2 class="text-lg font-semibold text-white flex items-center gap-2">
                                <span class="material-symbols-outlined">bar_chart</span>
                                사용량
                            </h2>
                        </div>
                        <!-- 사용량 대시보드 -->
                        <div class="flex-1 p-4 space-y-6 overflow-y-auto">
                            <!-- 오늘 사용량 카드 -->
                            <div class="bg-card-dark border border-card-border rounded-xl p-4">
                                <h3 class="text-sm font-medium text-text-muted mb-3">오늘 사용량</h3>
                                <div class="space-y-2">
                                    <div class="flex justify-between text-sm">
                                        <span id="usage-current" class="text-white font-semibold">0</span>
                                        <span id="usage-limit" class="text-text-muted">/ 5</span>
                                    </div>
                                    <div class="h-2 bg-background-dark rounded-full overflow-hidden">
                                        <div id="usage-progress-bar" class="h-full bg-primary rounded-full transition-all" style="width: 0%"></div>
                                    </div>
                                    <p id="usage-remaining" class="text-xs text-text-muted">남은 횟수: 5회</p>
                                </div>
                            </div>

                            <!-- 최근 7일 그래프 -->
                            <div class="bg-card-dark border border-card-border rounded-xl p-4">
                                <h3 class="text-sm font-medium text-text-muted mb-4">최근 7일</h3>
                                <div id="weekly-chart" class="flex items-end justify-between h-32 gap-2">
                                    <!-- 바 차트 (JS로 생성) -->
                                </div>
                            </div>

                            <!-- 스타일별 통계 -->
                            <div class="bg-card-dark border border-card-border rounded-xl p-4">
                                <h3 class="text-sm font-medium text-text-muted mb-4">스타일별 사용</h3>
                                <div id="style-stats" class="space-y-3">
                                    <!-- 스타일 바 (JS로 생성) -->
                                </div>
                                <p id="style-stats-empty" class="text-center text-text-muted text-sm py-4 hidden">통계 데이터가 없습니다</p>
                            </div>
                        </div>
                    </div>
                </div>
        </main>
    </div><!-- End Main Content Area -->

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Markmap for mindmap visualization -->
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdn.jsdelivr.net/npm/markmap-view@0.15.4"></script>
    <script src="https://cdn.jsdelivr.net/npm/markmap-lib@0.15.4"></script>

    <!-- Supabase JS SDK (PKCE OAuth Flow) - main.js보다 먼저 로드 -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Sidebar Toggle Script -->
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebar-overlay');
            sidebar.classList.toggle('-translate-x-full');
            overlay.classList.toggle('hidden');
        }

        // 탭(패널 뷰) 전환
        function switchPanelView(viewName) {
            // 모든 패널 뷰 숨기기
            document.querySelectorAll('.panel-view').forEach(view => {
                view.classList.add('hidden');
            });

            // 선택한 뷰만 표시
            const targetView = document.getElementById(`${viewName}-view`);
            if (targetView) {
                targetView.classList.remove('hidden');
            }

            // 아이콘 버튼 활성화 상태 업데이트
            document.querySelectorAll('.nav-icon-btn[data-section]').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.section === viewName);
            });

            // 뷰별 초기화 이벤트
            if (viewName === 'history') {
                window.dispatchEvent(new CustomEvent('panel:history-opened'));
            } else if (viewName === 'usage') {
                window.dispatchEvent(new CustomEvent('panel:usage-opened'));
            }
        }

        // 아이콘 바 버튼 클릭 이벤트 (Dashboard, History, Usage)
        document.querySelectorAll('.nav-icon-btn[data-section]').forEach(btn => {
            btn.addEventListener('click', () => {
                const section = btn.dataset.section;
                if (section && section !== 'settings') {
                    switchPanelView(section);
                    if (window.innerWidth < 1024) toggleSidebar();
                }
            });
        });

        // 전역으로 노출 (다른 모듈에서 사용)
        window.switchPanelView = switchPanelView;

        // Sidebar settings button
        document.getElementById('sidebar-settings-btn')?.addEventListener('click', () => {
            document.getElementById('settings-modal')?.classList.add('active');
            if (window.innerWidth < 1024) toggleSidebar();
        });

        // Sidebar auth container click
        document.getElementById('sidebar-auth-container')?.addEventListener('click', () => {
            document.getElementById('auth-modal')?.classList.add('active');
            if (window.innerWidth < 1024) toggleSidebar();
        });
    </script>

    <script type="module" src="/static/js/main.js"></script>

    <!-- ==================== Mobile Bottom Navigation ==================== -->
    <nav id="mobile-bottom-nav" class="lg:hidden fixed bottom-0 left-0 right-0 z-50 bg-background-dark/95 backdrop-blur-md border-t border-card-border/50">
        <div class="grid grid-cols-4 h-14 pb-safe">
            <button class="mobile-nav-item active" data-section="dashboard" onclick="scrollToSection('url-input')">
                <span class="material-symbols-outlined">dashboard</span>
                <span>홈</span>
            </button>
            <button class="mobile-nav-item" data-section="styles" onclick="scrollToSection('style-options')">
                <span class="material-symbols-outlined">palette</span>
                <span>스타일</span>
            </button>
            <button class="mobile-nav-item" data-section="reports" onclick="scrollToSection('report-stream')">
                <span class="material-symbols-outlined">article</span>
                <span>리포트</span>
            </button>
            <button class="mobile-nav-item" data-section="settings" onclick="document.getElementById('settings-modal')?.classList.add('active')">
                <span class="material-symbols-outlined">settings</span>
                <span>설정</span>
            </button>
        </div>
    </nav>
    <script>
        function scrollToSection(elementId) {
            const element = document.getElementById(elementId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            // Update active state
            document.querySelectorAll('.mobile-nav-item').forEach(btn => btn.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }
    </script>

    <!-- 모바일 탭 바 (768px 이하에서만 표시) -->
    <div class="mobile-tab-bar">
        <button class="mobile-tab active" data-panel="input">
            <span class="material-symbols-outlined">edit</span>
            <span>입력</span>
        </button>
        <button class="mobile-tab" data-panel="result">
            <span class="material-symbols-outlined">article</span>
            <span>결과</span>
        </button>
        <button class="mobile-tab" data-panel="settings" onclick="document.getElementById('settings-modal')?.classList.add('active')">
            <span class="material-symbols-outlined">settings</span>
            <span>설정</span>
        </button>
    </div>

    <script>
        // 모바일 탭 전환
        document.querySelectorAll('.mobile-tab[data-panel]').forEach(tab => {
            tab.addEventListener('click', () => {
                const panel = tab.dataset.panel;
                if (panel === 'settings') return;

                document.querySelectorAll('.mobile-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                document.getElementById('input-panel')?.classList.toggle('active', panel === 'input');
                document.getElementById('result-panel')?.classList.toggle('active', panel === 'result');
            });
        });

        // 모바일 초기 상태: 768px 이하에서 입력 패널 활성화
        if (window.innerWidth <= 768) {
            document.getElementById('input-panel')?.classList.add('active');
        }

        // 화면 크기 변경 시 패널 상태 조정
        window.addEventListener('resize', () => {
            if (window.innerWidth <= 768) {
                // 모바일: 탭 상태에 따라 패널 표시
                const activeTab = document.querySelector('.mobile-tab.active');
                const activePanel = activeTab?.dataset.panel;
                if (activePanel && activePanel !== 'settings') {
                    document.getElementById('input-panel')?.classList.toggle('active', activePanel === 'input');
                    document.getElementById('result-panel')?.classList.toggle('active', activePanel === 'result');
                }
            }
        });
    </script>
</body>
</html>
