<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Insight Engine — AI Content Analysis</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <!-- FOUC 방지: DOM 로드 전 저장된 테마 적용 -->
    <script>
        (function() {
            const storageKey = 'cad_theme_v1';
            const saved = localStorage.getItem(storageKey);
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

            let theme;
            if (saved === 'light') {
                theme = 'light';
            } else if (saved === 'dark') {
                theme = 'dark';
            } else {
                // system 또는 저장 없음 → 시스템 설정 따름
                theme = prefersDark ? 'dark' : 'light';
            }

            document.documentElement.setAttribute('data-theme', theme);
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <!-- 폰트 최적화: preconnect 및 preload -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin/>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin/>
    <!-- 웹폰트: Pretendard (한글, 메인) + Space Grotesk (영문 디스플레이) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                screens: {
                    'xs': '375px',
                    'sm': '640px',
                    'md': '768px',
                    'lg': '1024px',
                    'xl': '1280px',
                    '2xl': '1536px'
                },
                extend: {
                    colors: {
                        // US-015: WCAG AA 색상 대비 기준 충족 (4.5:1 이상)
                        // 틸(Teal) 컬러 시스템 - 다크모드 기준
                        "primary": "#2aa3ba",        /* 대비 5.4:1 vs #16191d */
                        "primary-hover": "#1f8a9e",
                        "primary-glow": "#3eb8cf",
                        // 배경/표면
                        "background-dark": "#16191d",
                        "background-base": "#16191d",
                        "surface-dark": "#202428",
                        "card-dark": "#202428",
                        "bg-elevated": "#282c31",
                        // 텍스트 - WCAG AA 충족
                        "text-light": "#ffffff",     /* 대비 15.5:1 vs #16191d */
                        "text-primary": "#ffffff",
                        "text-secondary": "#a8b0ba", /* 대비 6.1:1 vs #16191d */
                        "text-subtle": "#7ec8d6",    /* 대비 6.0:1 vs #16191d */
                        "gray-text": "#a8b0ba",      /* 대비 6.1:1 vs #16191d */
                        "warm-white": "#ffffff",
                        // 테두리 - 가시성 향상
                        "border-dark": "#3a3f45",
                        "card-border": "#4a7a85"
                    },
                    fontFamily: {
                        "display": ["Space Grotesk", "Pretendard", "sans-serif"],
                        "body": ["Space Grotesk", "Pretendard", "sans-serif"],
                        "mono": ["JetBrains Mono", "monospace"]
                    },
                    fontSize: {
                        // US-017: 4단계 타이포그래피 스케일 (최소 14px 보장)
                        'xs': ['0.875rem', { lineHeight: '1.5' }],     // 14px - 최소 크기
                        'sm': ['0.875rem', { lineHeight: '1.5' }],     // 14px - 캡션/보조
                        'base': ['1rem', { lineHeight: '1.625' }],     // 16px - 본문
                        'lg': ['1.125rem', { lineHeight: '1.625' }],   // 18px - 큰 본문
                        'xl': ['1.25rem', { lineHeight: '1.375' }],    // 20px - h4
                        '2xl': ['1.5rem', { lineHeight: '1.375' }],    // 24px - h3
                        '3xl': ['1.875rem', { lineHeight: '1.25' }],   // 30px - h2
                        '4xl': ['2.25rem', { lineHeight: '1.25' }],    // 36px - h1
                    },
                    lineHeight: {
                        'tight': '1.25',
                        'snug': '1.375',
                        'normal': '1.5',
                        'relaxed': '1.625',
                        'loose': '1.75',
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "2xl": "1rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        /* ==================== Base Styles - Teal Design System ==================== */

        /* ========== Light Mode (기본) ========== */
        /* US-015: WCAG AA 색상 대비 기준 충족 (4.5:1 이상) */
        :root {
            --primary: #0a6073;           /* 대비 5.2:1 vs #f5f7f9 */
            --primary-hover: #085463;
            --primary-glow: #0d8fa8;
            --background-dark: #f5f7f9;
            --surface-dark: #ffffff;
            --card-dark: #ffffff;
            --bg-elevated: #e8ecef;
            --text-primary: #1f2937;      /* 대비 11.7:1 vs #f5f7f9 */
            --text-muted: #525a66;        /* 대비 5.5:1 vs #f5f7f9 (기존 #6b7280은 4.19:1) */
            --text-subtle: #0a6073;       /* 대비 5.2:1 vs #f5f7f9 */
            --border-dark: #d1d5db;       /* 더 진한 테두리 */
            --card-border: #0a607340;
            /* Compact Design Variables */
            --spacing-xs: 0.25rem;   /* 4px */
            --spacing-sm: 0.5rem;    /* 8px */
            --spacing-md: 0.75rem;   /* 12px */
            --spacing-lg: 1rem;      /* 16px */
            --spacing-xl: 1.25rem;   /* 20px */

            /* US-017: 타이포그래피 스케일 */
            --font-size-caption: 0.875rem;   /* 14px - 최소 크기 */
            --font-size-body: 1rem;          /* 16px - 본문 */
            --font-size-body-lg: 1.125rem;   /* 18px - 큰 본문 */
            --font-size-h4: 1.25rem;         /* 20px - 소제목 */
            --font-size-h3: 1.5rem;          /* 24px - 중제목 */
            --font-size-h2: 1.875rem;        /* 30px - 대제목 */
            --font-size-h1: 2.25rem;         /* 36px - 페이지 제목 */

            /* Line Heights */
            --line-height-tight: 1.25;
            --line-height-snug: 1.375;
            --line-height-normal: 1.5;
            --line-height-relaxed: 1.625;
            --line-height-loose: 1.75;
        }

        /* ========== Dark Mode ========== */
        /* US-015: WCAG AA 색상 대비 기준 충족 (4.5:1 이상) */
        [data-theme="dark"] {
            --primary: #2aa3ba;           /* 대비 5.4:1 vs #16191d */
            --primary-hover: #1f8a9e;
            --primary-glow: #3eb8cf;
            --background-dark: #16191d;
            --surface-dark: #202428;
            --card-dark: #202428;
            --bg-elevated: #282c31;
            --text-primary: #ffffff;      /* 대비 15.5:1 vs #16191d */
            --text-muted: #a8b0ba;        /* 대비 6.1:1 vs #16191d (기존 #9ca3af는 5.5:1로 충족) */
            --text-subtle: #7ec8d6;       /* 대비 6.0:1 vs #16191d */
            --border-dark: #3a3f45;       /* 더 밝은 테두리로 가시성 향상 */
            --card-border: #4a7a85;       /* 더 밝은 카드 테두리 */
        }

        /* ==================== US-017: Typography Scale System ==================== */

        /* Headings - 제목 스타일 */
        h1, .h1, .page-title {
            font-size: var(--font-size-h1);
            font-weight: 700;
            line-height: var(--line-height-tight);
            letter-spacing: -0.025em;
        }

        h2, .h2, .section-title {
            font-size: var(--font-size-h2);
            font-weight: 700;
            line-height: var(--line-height-tight);
            letter-spacing: -0.02em;
        }

        h3, .h3, .card-title {
            font-size: var(--font-size-h3);
            font-weight: 600;
            line-height: var(--line-height-snug);
            letter-spacing: -0.015em;
        }

        h4, .h4, .subsection-title {
            font-size: var(--font-size-h4);
            font-weight: 600;
            line-height: var(--line-height-snug);
            letter-spacing: -0.01em;
        }

        /* Body Text - 본문 스타일 */
        body {
            font-size: var(--font-size-body);
            line-height: var(--line-height-relaxed);
        }

        p, .body-text {
            font-size: var(--font-size-body);
            line-height: var(--line-height-relaxed);
        }

        .body-lg {
            font-size: var(--font-size-body-lg);
            line-height: var(--line-height-relaxed);
        }

        /* Caption - 캡션/보조 텍스트 (최소 14px) */
        .caption, small, .text-caption {
            font-size: var(--font-size-caption);
            line-height: var(--line-height-normal);
        }

        /* Overline/Label - 라벨/카테고리용 */
        .overline, .text-label {
            font-size: var(--font-size-caption);
            font-weight: 600;
            line-height: var(--line-height-normal);
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }

        /* ==================== 3-Column Layout Grid System ==================== */

        /* Main Layout Container */
        .app-layout {
            display: flex;
            height: 100vh;
            width: 100%;
            overflow: hidden;
        }

        /* Sidebar - 200px fixed width */
        #sidebar {
            width: 200px !important;
            min-width: 200px;
            max-width: 200px;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-dark);
            background: var(--background-dark);
            height: 100%;
            z-index: 50;
        }

        /* Input Panel - 350px fixed width */
        #input-panel {
            width: 350px !important;
            min-width: 320px;
            max-width: 400px;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-dark);
            background: var(--background-dark);
            height: 100%;
            overflow-y: auto;
        }

        /* Result Panel - flex-1 (remaining space) */
        #result-panel {
            flex: 1 1 0%;
            min-width: 400px;
            display: flex;
            flex-direction: column;
            background: var(--background-dark);
            height: 100%;
            overflow-y: auto;
        }

        /* Main Content Area - contains input and result panels */
        #main-content {
            flex: 1;
            display: flex;
            height: 100%;
            overflow: hidden;
        }

        /* Main Container - flex column for header + content */
        .main-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
        }

        /* Content Area - flex row for panels */
        .content-area {
            flex: 1;
            display: flex;
            height: 100%;
            overflow: hidden;
        }

        /* ==================== Compact Design System ==================== */

        /* Header - 56px → 48px */
        header.h-14 { height: 48px !important; }

        /* Sidebar internal layout */
        #sidebar .sidebar-header {
            height: 48px !important;
            padding: 0 var(--spacing-md);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            border-bottom: 1px solid var(--border-dark);
        }
        #sidebar .sidebar-logo {
            width: 28px !important;
            height: 28px !important;
            flex-shrink: 0;
        }
        #sidebar .sidebar-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        #sidebar .nav-icon-btn {
            width: 100% !important;
            height: 40px !important;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: 0 var(--spacing-md);
            border-radius: var(--radius-md);
            transition: background-color 0.2s, color 0.2s;
        }
        #sidebar .nav-icon-btn .material-symbols-outlined {
            font-size: 20px !important;
            flex-shrink: 0;
        }
        #sidebar .nav-icon-btn .nav-label {
            font-size: 13px;
            font-weight: 500;
            white-space: nowrap;
        }

        /* Input Panel Sections - p-4 → p-3 */
        #input-panel > div.p-4 { padding: 0.75rem !important; }
        #input-panel > div.p-4.border-b { padding: 0.75rem !important; }

        /* Section Headers - mb-3 → mb-2 */
        #input-panel .mb-3 { margin-bottom: 0.5rem !important; }
        #input-panel .mb-4 { margin-bottom: 0.75rem !important; }

        /* Gaps - gap-2 → gap-1.5, gap-3 → gap-2 */
        #input-panel .gap-2 { gap: 0.375rem !important; }
        #input-panel .gap-3 { gap: 0.5rem !important; }
        #input-panel .gap-1\.5 { gap: 0.25rem !important; }

        /* Space-y adjustments */
        #input-panel .space-y-2 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.375rem !important; }
        #input-panel .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.5rem !important; }

        /* Input fields - py-2.5 → py-2 */
        #input-panel input.py-2\.5,
        #input-panel select.py-2\.5 { padding-top: 0.5rem !important; padding-bottom: 0.5rem !important; }
        #input-panel .px-3 { padding-left: 0.5rem !important; padding-right: 0.5rem !important; }

        /* Style cards - smaller padding */
        #input-panel .style-card,
        #input-panel [class*="style-options"] label > div {
            padding: 0.375rem 0.625rem !important;
        }

        /* Buttons - smaller */
        #input-panel button.py-3 { padding-top: 0.625rem !important; padding-bottom: 0.625rem !important; }
        #input-panel button.py-2\.5 { padding-top: 0.5rem !important; padding-bottom: 0.5rem !important; }

        /* Result Panel Header */
        #result-panel > div > div.p-4 { padding: 0.75rem !important; }

        /* Report cards - compact spacing */
        .report-card { margin-bottom: 0.75rem !important; }
        .report-card .p-4 { padding: 0.75rem !important; }
        .report-card .p-6 { padding: 1rem !important; }

        /* Modal - compact */
        .modal-content.p-6 { padding: 1rem !important; }
        .modal-content .mb-6 { margin-bottom: 1rem !important; }
        .modal-content .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.75rem !important; }
        .modal-content .space-y-3 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.5rem !important; }

        /* Alert - compact */
        .alert { padding: 0.625rem 1rem !important; margin-bottom: 0.75rem !important; }

        /* Provider card - compact */
        .provider-card { padding: 0.75rem !important; }

        /* History item - compact */
        .history-item { padding: 0.75rem !important; }
        .history-item-header { margin-bottom: 0.375rem !important; }

        /* Header elements - compact */
        header .px-6 { padding-left: 1rem !important; padding-right: 1rem !important; }
        header .gap-3 { gap: 0.5rem !important; }
        header .px-3 { padding-left: 0.5rem !important; padding-right: 0.5rem !important; }
        header .py-1\.5 { padding-top: 0.25rem !important; padding-bottom: 0.25rem !important; }

        /* Report content - slightly tighter */
        .report-content { line-height: 1.6 !important; }
        .report-content h1 { margin: 1rem 0 0.5rem 0 !important; }
        .report-content h2 { margin: 0.875rem 0 0.375rem 0 !important; }
        .report-content h3 { margin: 0.75rem 0 0.25rem 0 !important; }
        .report-content p { margin: 0.5rem 0 !important; }
        .report-content ul, .report-content ol { margin: 0.5rem 0 !important; }
        .report-content li { margin: 0.25rem 0 !important; }
        .report-content blockquote { margin: 0.75rem 0 !important; padding: 0.75rem 1rem !important; }
        .report-content pre { margin: 0.75rem 0 !important; padding: 0.75rem !important; }
        .report-content table { margin: 1rem 0 !important; }
        .report-content th, .report-content td { padding: 0.625rem 1rem !important; }
        .report-content .highlight-box, .report-content .key-point { margin: 1rem 0 !important; padding: 1rem !important; }
        .report-content .summary, .report-content .executive-summary { padding: 1rem !important; margin: 1rem 0 !important; }

        /* Advanced options panel - compact */
        #advanced-options-panel.p-4 { padding: 0.75rem !important; }
        #advanced-options-panel .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.75rem !important; }
        #advanced-options-panel label > div.p-2 { padding: 0.375rem !important; }

        /* Dashboard/History/Usage views - compact */
        #dashboard-view .p-4 { padding: 0.75rem !important; }
        #history-view .p-4 { padding: 0.75rem !important; }
        #usage-view .p-4 { padding: 0.75rem !important; }

        /* URL list container - compact */
        #url-list-container { max-height: 120px !important; }
        #url-list-container .space-y-1\.5 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.25rem !important; }

        /* Style section labels - tighter */
        #input-panel .text-\[10px\] { margin-bottom: 0.375rem !important; }

        /* Flex wrap gaps - compact */
        .flex-wrap.gap-1\.5 { gap: 0.25rem !important; }
        .flex-wrap.gap-2 { gap: 0.375rem !important; }

        /* Panel view headers - compact */
        .panel-view .p-4.border-b { padding: 0.625rem 0.75rem !important; }

        /* Icon sizes in compact mode */
        #input-panel .material-symbols-outlined.text-sm { font-size: 14px !important; }
        #input-panel .material-symbols-outlined.text-base { font-size: 15px !important; }
        #input-panel .material-symbols-outlined.text-lg { font-size: 18px !important; }

        /* Select dropdowns - compact */
        #input-panel select { padding: 0.5rem 2rem 0.5rem 0.5rem !important; }

        /* Result panel - compact header and content */
        #result-panel .text-lg { font-size: 1rem !important; }
        #result-panel .border-b.flex-shrink-0 { padding: 0.625rem 0.75rem !important; }

        /* Stats badges - compact */
        .stats-badge { padding: 0.125rem 0.5rem !important; font-size: 0.625rem !important; }

        /* Cards container - reduce spacing */
        #cards-container { padding: 0.75rem !important; }
        #cards-container > * { margin-bottom: 0.75rem !important; }

        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        /* Focus styles for accessibility */
        :focus-visible {
            outline: 2px solid #0f758a;
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(15, 117, 138, 0.2);
        }

        /* Remove default focus for mouse users */
        :focus:not(:focus-visible) {
            outline: none;
            box-shadow: none;
        }

        /* Skip link for keyboard users */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #0f758a;
            color: #ffffff;
            padding: 8px 16px;
            z-index: 100;
            transition: top 0.2s;
        }
        .skip-link:focus {
            top: 0;
        }

        /* Screen reader only - visually hidden but accessible */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        .glass-panel {
            background: #1a1d21;
            border: 1px solid #2a2e33;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #16191d;
        }
        ::-webkit-scrollbar-thumb {
            background: #345d65;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #0f758a;
        }

        /* Subtle shadow */
        .warm-glow {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        .warm-glow:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        /* Animations */
        .animate-pulse-slow {
            animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(2deg); }
        }
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        .animate-shimmer {
            background: linear-gradient(90deg, transparent, rgba(15, 117, 138, 0.1), transparent);
            background-size: 200% 100%;
            animation: shimmer 3s infinite;
        }

        /* Skeleton Loading */
        .skeleton {
            background: linear-gradient(90deg,
                rgba(42, 42, 42, 0.6) 0%,
                rgba(60, 60, 60, 0.6) 50%,
                rgba(42, 42, 42, 0.6) 100%
            );
            background-size: 200% 100%;
            animation: shimmer 1.5s ease-in-out infinite;
            border-radius: 4px;
        }
        .skeleton-text {
            height: 14px;
            margin-bottom: 8px;
        }
        .skeleton-text-sm {
            height: 10px;
            margin-bottom: 6px;
        }
        .skeleton-title {
            height: 24px;
            width: 70%;
            margin-bottom: 12px;
        }
        .skeleton-badge {
            height: 24px;
            width: 60px;
            border-radius: 6px;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }

        /* Modal Styles - Enhanced Design */
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            z-index: 100;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.2s ease-out;
        }
        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }
        .modal-content {
            background: linear-gradient(145deg, #1e2127 0%, #16181c 100%);
            border: 1px solid rgba(173, 43, 238, 0.2);
            border-radius: 16px;
            max-width: 520px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow:
                0 24px 64px rgba(0, 0, 0, 0.6),
                0 0 0 1px rgba(255, 255, 255, 0.05) inset,
                0 0 80px rgba(173, 43, 238, 0.1);
            transform: scale(0.95) translateY(10px);
            opacity: 0;
            animation: modalSlideIn 0.25s ease-out forwards;
        }
        @keyframes modalSlideIn {
            to {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }
        .modal-overlay:not(.active) .modal-content {
            animation: modalSlideOut 0.2s ease-in forwards;
        }
        @keyframes modalSlideOut {
            from {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
            to {
                transform: scale(0.95) translateY(10px);
                opacity: 0;
            }
        }

        /* Modal Close Button - Enhanced */
        .modal-close-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-muted);
            transition: all 0.2s ease;
            cursor: pointer;
        }
        .modal-close-btn:hover {
            background: rgba(239, 68, 68, 0.15);
            border-color: rgba(239, 68, 68, 0.3);
            color: #ef4444;
            transform: rotate(90deg);
        }
        .modal-close-btn:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(173, 43, 238, 0.3);
        }

        /* Modal Header */
        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-bottom: 1rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }

        /* Provider Card (for settings modal display) */
        .provider-card {
            border: 1px solid #2a2e33;
            background: #1e2227;
            padding: 1rem;
            border-radius: 8px;
        }
        .provider-card.configured {
            border-color: #0f758a;
            background: #1e2227;
        }

        /* Loading Spinner */
        .loading-spinner {
            display: inline-block;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ==================== Result Card System ==================== */

        /* Result Card Container - 개별 결과 묶음 */
        .result-card-group {
            display: flex;
            flex-direction: column;
            gap: 16px;
            opacity: 0;
            transform: translateY(20px);
            animation: slideInUp 0.4s ease forwards;
            margin-bottom: 24px;
        }

        /* Base Result Card - 공통 스타일 */
        .result-card {
            background: var(--surface-dark, #202428);
            border: 1px solid var(--border-dark, #2a2e33);
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            transition: all 0.2s ease;
            overflow: hidden;
            position: relative;
        }

        .result-card:hover {
            border-color: var(--primary, #0f758a);
            box-shadow: 0 4px 16px rgba(15, 117, 138, 0.15);
            transform: translateY(-2px);
        }

        /* Card Header with Copy Button */
        .result-card-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 12px;
            padding: 16px;
        }

        /* Title Card Specific */
        .result-card--title {
            border-left: 3px solid var(--primary, #0f758a);
        }

        .result-card--title .result-card-header {
            padding-bottom: 12px;
        }

        .result-card--title .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary, #ffffff);
            line-height: 1.4;
            margin: 0;
        }

        .result-card--title .card-meta {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .result-card--title .style-badge {
            background: linear-gradient(135deg, var(--primary, #0f758a), var(--primary-glow, #14a3bd));
            color: #ffffff;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 4px 10px;
            border-radius: 4px;
        }

        .result-card--title .time-badge {
            color: var(--text-secondary, #9ca3af);
            font-size: 11px;
            font-family: var(--font-mono, 'JetBrains Mono', monospace);
        }

        .result-card--title .source-link {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            color: var(--text-secondary, #9ca3af);
            font-size: 12px;
            text-decoration: none;
            transition: color 0.2s ease;
            margin-top: 8px;
        }

        .result-card--title .source-link:hover {
            color: var(--primary, #0f758a);
        }

        /* Content Card Specific */
        .result-card--content {
            border-left: 3px solid var(--primary-glow, #14a3bd);
        }

        .result-card--content .result-card-header {
            background: var(--background-dark, #16191d);
            border-bottom: 1px solid var(--border-dark, #2a2e33);
            padding: 12px 16px;
        }

        .result-card--content .card-label {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary, #9ca3af);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .result-card--content .card-body {
            padding: 20px;
        }

        /* Meta Card Specific */
        .result-card--meta {
            border-left: 3px solid #6366f1;
        }

        .result-card--meta .result-card-header {
            background: var(--background-dark, #16191d);
            border-bottom: 1px solid var(--border-dark, #2a2e33);
            padding: 12px 16px;
        }

        .result-card--meta .card-label {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary, #9ca3af);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .result-card--meta .card-body {
            padding: 16px;
        }

        .result-card--meta .meta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 16px;
        }

        .result-card--meta .meta-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .result-card--meta .meta-label {
            font-size: 11px;
            color: var(--text-secondary, #9ca3af);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .result-card--meta .meta-value {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary, #ffffff);
            font-family: var(--font-mono, 'JetBrains Mono', monospace);
        }

        /* Copy Button */
        .card-copy-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            padding: 6px 10px;
            background: transparent;
            border: 1px solid var(--border-dark, #2a2e33);
            border-radius: 6px;
            color: var(--text-secondary, #9ca3af);
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .card-copy-btn:hover {
            background: var(--primary, #0f758a);
            border-color: var(--primary, #0f758a);
            color: #ffffff;
        }

        .card-copy-btn.copied {
            background: #10b981;
            border-color: #10b981;
            color: #ffffff;
        }

        .card-copy-btn .material-symbols-outlined {
            font-size: 14px;
        }

        /* Card Actions Footer */
        .result-card-actions {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 8px;
            padding: 12px 16px;
            background: var(--background-dark, #16191d);
            border-top: 1px solid var(--border-dark, #2a2e33);
        }

        .result-card-actions button {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 6px 12px;
            font-size: 11px;
            font-weight: 500;
            color: var(--text-secondary, #9ca3af);
            background: transparent;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .result-card-actions button:hover {
            background: var(--primary, #0f758a);
            background-opacity: 0.1;
            color: var(--primary, #0f758a);
        }

        .result-card-actions button.delete-btn:hover {
            color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        /* Legacy Report Card - 기존 호환성 유지 */
        .report-card {
            opacity: 0;
            transform: translateY(20px);
            animation: slideInUp 0.4s ease forwards;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }
        .report-card:hover {
            border-color: #0f758a;
            box-shadow: 0 4px 16px rgba(15, 117, 138, 0.15);
            transform: translateY(-2px);
        }
        .report-card .card-header {
            background: transparent;
        }
        .report-card .card-footer {
            background: transparent;
        }
        .report-card .card-footer button {
            transition: opacity 0.2s ease;
        }
        .report-card .card-footer button:hover {
            opacity: 0.8;
        }
        .report-card .stats-badge {
            background: #1e2227;
            border: 1px solid #2a2e33;
            padding: 0.25rem 0.625rem;
            border-radius: 4px;
            font-size: 0.6875rem;
        }
        @keyframes slideInUp {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes slideOut {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(-10px);
            }
        }

        /* Input focus enhancement */
        input:focus, select:focus, textarea:focus {
            box-shadow: 0 0 0 2px rgba(15, 117, 138, 0.15);
        }

        /* Button press feedback */
        button:active:not(:disabled) {
            transform: scale(0.98);
        }

        /* Checkbox/Radio enhancement */
        input[type="checkbox"]:checked, input[type="radio"]:checked {
            background-color: #0f758a;
        }

        /* Alerts - US-015: WCAG AA 색상 대비 기준 충족 */
        .alert {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.875rem 1.25rem;
            border: 1px solid;
            border-radius: 8px;
            margin-bottom: 1rem;
            backdrop-filter: blur(8px);
        }
        /* 성공: #047857 대비 5.5:1 vs #f5f7f9 (라이트), #34D399 대비 8.0:1 vs #16191d (다크) */
        .alert-success {
            background: rgba(16, 185, 129, 0.08);
            border-color: rgba(16, 185, 129, 0.35);
            color: #047857;  /* 다크 모드에서 충분한 대비 확보 */
        }
        [data-theme="dark"] .alert-success {
            color: #34D399;  /* 다크 모드: 대비 8.0:1 vs #16191d */
        }
        /* 에러: #dc2626 대비 5.0:1 vs #f5f7f9 (라이트), #f87171 대비 6.0:1 vs #16191d (다크) */
        .alert-error {
            background: rgba(239, 68, 68, 0.08);
            border-color: rgba(239, 68, 68, 0.35);
            color: #dc2626;  /* 라이트 모드용 더 진한 빨강 */
        }
        [data-theme="dark"] .alert-error {
            color: #f87171;  /* 다크 모드: 대비 6.0:1 vs #16191d */
        }
        /* 경고: #b45309 대비 5.0:1 vs #f5f7f9 (라이트), #fbbf24 대비 10.5:1 vs #16191d (다크) */
        .alert-warning {
            background: rgba(245, 158, 11, 0.08);
            border-color: rgba(245, 158, 11, 0.35);
            color: #b45309;  /* 라이트 모드용 더 진한 주황 */
        }
        [data-theme="dark"] .alert-warning {
            color: #fbbf24;  /* 다크 모드: 대비 10.5:1 vs #16191d */
        }
        /* 정보: #0a6073 대비 5.2:1 vs #f5f7f9 (라이트), #2aa3ba 대비 5.4:1 vs #16191d (다크) */
        .alert-info {
            background: rgba(15, 117, 138, 0.08);
            border-color: rgba(15, 117, 138, 0.35);
            color: #0a6073;  /* 라이트 모드용 더 진한 틸 */
        }
        [data-theme="dark"] .alert-info {
            color: #2aa3ba;  /* 다크 모드: 대비 5.4:1 vs #16191d */
        }

        /* ==================== Report Content Styles ==================== */
        /* US-015: WCAG AA 색상 대비 기준 충족 - 라이트/다크 모드 대응 */
        .report-content {
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
            font-size: 1.1875rem;  /* 19px - 더 읽기 쉽게 */
            line-height: 1.7;      /* 컴팩트하게 */
            color: var(--text-primary);
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;
        }

        /* Headings - 다크 모드 */
        [data-theme="dark"] .report-content h1 {
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
            font-size: 1.75rem;
            font-weight: 700;
            color: #ffffff;            /* 대비 15.5:1 vs #16191d */
            margin: 1.25rem 0 0.625rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(42, 163, 186, 0.3);
            letter-spacing: -0.01em;
        }

        [data-theme="dark"] .report-content h2 {
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
            font-size: 1.375rem;
            font-weight: 600;
            color: #2dd4bf;            /* 대비 8.5:1 vs #16191d */
            margin: 1rem 0 0.5rem 0;
            letter-spacing: 0;
        }

        [data-theme="dark"] .report-content h2::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #2aa3ba;
            margin-right: 12px;
            transform: rotate(45deg);
        }

        [data-theme="dark"] .report-content h3 {
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
            font-size: 1.125rem;
            font-weight: 600;
            color: #f3f4f6;            /* 대비 13:1 vs #16191d */
            margin: 0.875rem 0 0.375rem 0;
        }

        [data-theme="dark"] .report-content h4 {
            font-size: 0.9375rem;
            font-weight: 600;
            color: #d1d5db;            /* 대비 10:1 vs #16191d */
            margin: 0.75rem 0 0.25rem 0;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Headings - 라이트 모드 */
        .report-content h1 {
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
            font-size: 1.75rem;
            font-weight: 700;
            color: #1f2937;            /* 대비 11.7:1 vs #f5f7f9 */
            margin: 1.25rem 0 0.625rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(10, 96, 115, 0.3);
            letter-spacing: -0.01em;
        }

        .report-content h2 {
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
            font-size: 1.375rem;
            font-weight: 600;
            color: #0d7377;            /* 대비 4.6:1 vs #f5f7f9 */
            margin: 1rem 0 0.5rem 0;
            letter-spacing: 0;
        }

        .report-content h2::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #0a6073;
            margin-right: 12px;
            transform: rotate(45deg);
        }

        .report-content h3 {
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
            font-size: 1.125rem;
            font-weight: 600;
            color: #374151;            /* 대비 8.5:1 vs #f5f7f9 */
            margin: 0.875rem 0 0.375rem 0;
        }

        .report-content h4 {
            font-size: 0.9375rem;
            font-weight: 600;
            color: #4b5563;            /* 대비 6.2:1 vs #f5f7f9 */
            margin: 0.75rem 0 0.25rem 0;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Paragraphs - US-015: 라이트/다크 모드 색상 대비 충족 */
        .report-content p {
            margin: 0.625rem 0;
            color: var(--text-primary);
        }

        /* Lists */
        .report-content ul,
        .report-content ol {
            margin: 0.625rem 0;
            padding-left: 0;
        }

        .report-content ul {
            list-style: none;
        }

        .report-content ul li {
            position: relative;
            padding-left: 1.5rem;
            margin: 0.375rem 0;
            color: var(--text-primary);
        }

        /* 리스트 마커 - 라이트 모드 */
        .report-content ul li::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0.625rem;
            width: 6px;
            height: 6px;
            background: linear-gradient(135deg, #0a6073, #085463);
            border-radius: 1px;
            transform: rotate(45deg);
        }

        /* 리스트 마커 - 다크 모드 */
        [data-theme="dark"] .report-content ul li::before {
            background: linear-gradient(135deg, #2aa3ba, #1f8a9e);
        }

        .report-content ol {
            list-style: none;
            counter-reset: item;
        }

        .report-content ol li {
            counter-increment: item;
            position: relative;
            padding-left: 2.25rem;
            margin: 0.375rem 0;
            color: var(--text-primary);
        }

        /* 순서 리스트 마커 - 라이트 모드 */
        .report-content ol li::before {
            content: counter(item);
            position: absolute;
            left: 0;
            width: 1.625rem;
            height: 1.625rem;
            background: linear-gradient(135deg, #0a6073 0%, #085463 100%);
            color: #ffffff;
            font-size: 0.75rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
        }

        /* 순서 리스트 마커 - 다크 모드 */
        [data-theme="dark"] .report-content ol li::before {
            background: linear-gradient(135deg, #2aa3ba 0%, #1f8a9e 100%);
        }

        /* Nested lists */
        .report-content ul ul,
        .report-content ol ol,
        .report-content ul ol,
        .report-content ol ul {
            margin: 0.5rem 0;
        }

        .report-content ul ul li::before {
            background: #525a66;       /* 라이트 모드: 대비 5.5:1 */
            width: 4px;
            height: 4px;
        }

        [data-theme="dark"] .report-content ul ul li::before {
            background: #a8b0ba;       /* 다크 모드: 대비 6.1:1 */
        }

        /* Blockquotes - US-015: 라이트/다크 모드 대응 */
        .report-content blockquote {
            margin: 1rem 0;
            padding: 1rem 1.25rem;
            background: linear-gradient(90deg, rgba(10, 96, 115, 0.08) 0%, transparent 100%);
            border-left: 3px solid var(--primary);
            color: var(--text-primary);
            font-style: italic;
            border-radius: 0 8px 8px 0;
        }

        [data-theme="dark"] .report-content blockquote {
            background: linear-gradient(90deg, rgba(42, 163, 186, 0.08) 0%, transparent 100%);
        }

        .report-content blockquote p {
            margin: 0;
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
        }

        /* Code blocks - 라이트 모드 */
        .report-content pre {
            margin: 1rem 0;
            padding: 1rem;
            background: #f8fafc;
            border: 1px solid var(--border-dark);
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8125rem;
            line-height: 1.7;
        }

        [data-theme="dark"] .report-content pre {
            background: #16191d;
            border-color: #3a3f45;
        }

        .report-content code {
            font-family: 'JetBrains Mono', monospace;
            background: rgba(10, 96, 115, 0.12);
            color: #0a6073;            /* 라이트 모드: 대비 5.2:1 */
            padding: 0.2rem 0.5rem;
            font-size: 0.85em;
            border-radius: 4px;
        }

        [data-theme="dark"] .report-content code {
            background: rgba(42, 163, 186, 0.12);
            color: #3eb8cf;            /* 다크 모드: 대비 7.2:1 */
        }

        .report-content pre code {
            background: transparent;
            color: var(--text-primary);
            padding: 0;
        }

        /* Tables - 라이트/다크 모드 대응 */
        .report-content table {
            width: 100%;
            margin: 1.75rem 0;
            border-collapse: collapse;
            font-size: 0.875rem;
            border-radius: 8px;
            overflow: hidden;
        }

        .report-content thead {
            background: linear-gradient(90deg, rgba(10, 96, 115, 0.15) 0%, rgba(10, 96, 115, 0.05) 100%);
        }

        [data-theme="dark"] .report-content thead {
            background: linear-gradient(90deg, rgba(42, 163, 186, 0.15) 0%, rgba(42, 163, 186, 0.05) 100%);
        }

        .report-content th {
            padding: 0.875rem 1.25rem;
            text-align: left;
            font-weight: 600;
            color: #0a6073;            /* 라이트 모드: 대비 5.2:1 */
            border-bottom: 1px solid rgba(10, 96, 115, 0.3);
            text-transform: uppercase;
            font-size: 0.6875rem;
            letter-spacing: 0.08em;
        }

        [data-theme="dark"] .report-content th {
            color: #2aa3ba;            /* 다크 모드: 대비 5.4:1 */
            border-bottom-color: rgba(42, 163, 186, 0.3);
        }

        .report-content td {
            padding: 0.875rem 1.25rem;
            border-bottom: 1px solid var(--border-dark);
            color: var(--text-primary);
        }

        .report-content tr:hover td {
            background: rgba(10, 96, 115, 0.04);
        }

        [data-theme="dark"] .report-content tr:hover td {
            background: rgba(42, 163, 186, 0.04);
        }

        /* Strong and emphasis - 라이트/다크 모드 대응 */
        .report-content strong {
            color: #1f2937;            /* 라이트 모드: 대비 11.7:1 */
            font-weight: 600;
        }

        [data-theme="dark"] .report-content strong {
            color: #ffffff;            /* 다크 모드: 대비 15.5:1 */
        }

        .report-content em {
            color: #0a6073;            /* 라이트 모드: 대비 5.2:1 */
            font-style: italic;
        }

        [data-theme="dark"] .report-content em {
            color: #3eb8cf;            /* 다크 모드: 대비 7.2:1 */
        }

        /* Links - 라이트/다크 모드 대응 */
        .report-content a {
            color: #0a6073;            /* 라이트 모드: 대비 5.2:1 */
            text-decoration: none;
            border-bottom: 1px solid rgba(10, 96, 115, 0.3);
            transition: all 0.2s;
        }

        .report-content a:hover {
            border-bottom-color: #0a6073;
            color: #085463;
        }

        [data-theme="dark"] .report-content a {
            color: #2aa3ba;            /* 다크 모드: 대비 5.4:1 */
            border-bottom-color: rgba(42, 163, 186, 0.3);
        }

        [data-theme="dark"] .report-content a:hover {
            border-bottom-color: #2aa3ba;
            color: #3eb8cf;
        }

        /* Horizontal rule - 라이트/다크 모드 대응 */
        .report-content hr {
            margin: 1.5rem 0;
            border: none;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(10, 96, 115, 0.3), transparent);
        }

        [data-theme="dark"] .report-content hr {
            background: linear-gradient(90deg, transparent, rgba(42, 163, 186, 0.3), transparent);
        }

        /* Key insights / highlights box - 라이트/다크 모드 대응 */
        .report-content .highlight-box,
        .report-content .key-point {
            margin: 1.75rem 0;
            padding: 1.5rem;
            background: rgba(10, 96, 115, 0.06);
            border: 1px solid rgba(10, 96, 115, 0.15);
            border-radius: 8px;
            position: relative;
        }

        [data-theme="dark"] .report-content .highlight-box,
        [data-theme="dark"] .report-content .key-point {
            background: rgba(42, 163, 186, 0.06);
            border-color: rgba(42, 163, 186, 0.15);
        }

        .report-content .highlight-box::before {
            content: '✦';
            position: absolute;
            top: -0.625rem;
            left: 1rem;
            background: #16191d;
            padding: 0 0.5rem;
            color: #0f758a;
        }

        /* Summary section styling */
        .report-content .summary,
        .report-content .executive-summary {
            padding: 1.75rem;
            background: linear-gradient(135deg, rgba(15, 117, 138, 0.08) 0%, rgba(13, 101, 119, 0.04) 100%);
            border-left: 3px solid #0f758a;
            border-radius: 0 8px 8px 0;
            margin: 1.75rem 0;
        }

        /* Tags / Keywords */
        .report-content .tag,
        .report-content .keyword {
            display: inline-block;
            padding: 0.3rem 0.875rem;
            background: rgba(15, 117, 138, 0.12);
            color: #0f758a;
            font-size: 0.6875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            margin: 0.25rem;
            border-radius: 4px;
        }

        /* Metric / Score displays */
        .report-content .metric {
            display: inline-flex;
            align-items: center;
            gap: 0.625rem;
            padding: 0.625rem 1.25rem;
            background: #202428;
            border: 1px solid #2a2e33;
            border-radius: 6px;
        }

        .report-content .metric-value {
            font-size: 1.625rem;
            font-weight: 700;
            color: #0f758a;
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
        }

        .report-content .metric-label {
            font-size: 0.6875rem;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Style Card Enhancement */
        .style-card {
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .style-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }
        /* Style card selection animation */
        @keyframes cardSelect {
            0% { transform: scale(0.96); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        .style-card:has(input:checked) {
            animation: cardSelect 0.3s ease-out;
        }

        /* Disabled Button Reason Overlay */
        .disabled-reason-overlay {
            position: absolute;
            bottom: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%) scale(0.95);
            background: rgba(32, 36, 40, 0.95);
            border: 1px solid rgba(15, 117, 138, 0.3);
            border-radius: 8px;
            padding: 8px 14px;
            font-size: 11px;
            color: #0f758a;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            z-index: 50;
            display: flex;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            pointer-events: none;
        }
        .disabled-reason-overlay::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: rgba(15, 117, 138, 0.3);
        }
        button.has-disabled-reason:disabled:hover .disabled-reason-overlay {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) scale(1);
        }

        /* Toast Animation */
        @keyframes toastSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .alert {
            animation: toastSlideIn 0.3s ease-out;
        }

        /* Mindmap Styles */
        #mindmap-svg {
            background: #16191d;
        }
        #mindmap-svg text {
            fill: #ffffff;
            font-family: 'Space Grotesk', 'Pretendard', sans-serif;
            font-size: 14px;
        }
        #mindmap-svg .markmap-node-circle {
            fill: #0f758a;
        }
        #mindmap-svg .markmap-link {
            stroke: rgba(15, 117, 138, 0.4);
        }
        #mindmap-svg .markmap-foreign {
            background: transparent;
        }

        /* ==================== Responsive Breakpoints System ==================== */

        /* Hamburger Menu Button (hidden by default) */
        .hamburger-btn {
            display: none;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            border-radius: 10px;
            background: transparent;
            border: 1px solid transparent;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .hamburger-btn:hover {
            background: var(--surface-dark);
            border-color: var(--border-dark);
        }
        .hamburger-btn:active {
            transform: scale(0.95);
        }
        .hamburger-btn:focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }
        .hamburger-btn .material-symbols-outlined {
            font-size: 24px;
            color: var(--text-primary);
            transition: transform 0.2s ease;
        }
        .hamburger-btn:hover .material-symbols-outlined {
            color: var(--primary);
        }
        /* Animated hamburger to X transformation */
        .hamburger-btn.active .material-symbols-outlined {
            transform: rotate(90deg);
        }

        /* Mobile Tab Bar (hidden by default, shown on sm) */
        .mobile-tab-bar {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--surface-dark);
            border-top: 1px solid var(--border-dark);
            z-index: 60;
            padding-bottom: env(safe-area-inset-bottom, 0px);
        }
        .mobile-tab-bar button {
            flex: 1;
            padding: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
            color: var(--text-muted);
            font-size: 10px;
            font-weight: 500;
            border: none;
            background: transparent;
            min-height: 48px;
            cursor: pointer;
            transition: color 0.2s;
        }
        .mobile-tab-bar button.active {
            color: var(--primary);
        }
        .mobile-tab-bar button .material-symbols-outlined {
            font-size: 22px;
        }

        /* Mobile Bottom Navigation */
        .mobile-nav-item {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            padding: 8px 4px;
            color: var(--text-muted);
            font-size: 10px;
            font-weight: 500;
            border: none;
            background: transparent;
            cursor: pointer;
            transition: color 0.2s ease, transform 0.2s ease;
        }
        .mobile-nav-item:hover {
            color: var(--text-primary);
        }
        .mobile-nav-item:active {
            transform: scale(0.95);
        }
        .mobile-nav-item.active {
            color: var(--primary);
        }
        /* Active indicator dot */
        .mobile-nav-item.active::after {
            content: '';
            position: absolute;
            bottom: 4px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--primary);
        }
        .mobile-nav-item .material-symbols-outlined {
            font-size: 24px;
            transition: transform 0.2s ease;
        }
        .mobile-nav-item.active .material-symbols-outlined {
            transform: translateY(-2px);
        }
        .pb-safe {
            padding-bottom: env(safe-area-inset-bottom, 0px);
        }

        /* Sidebar Overlay */
        #sidebar-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 90;
            backdrop-filter: blur(2px);
        }
        #sidebar-overlay.active {
            display: block;
        }

        /* ========== xl (1280px+): 3-column layout - Full sidebar, Input panel, Result panel ========== */
        @media (min-width: 1280px) {
            .mobile-tab-bar {
                display: none !important;
            }
            #mobile-bottom-nav {
                display: none !important;
            }
            #sidebar {
                width: 200px !important;
                min-width: 200px;
                max-width: 200px;
                position: static;
                transform: none;
            }
            #sidebar .sidebar-title {
                display: block;
            }
            #sidebar .nav-label {
                display: inline;
            }
            #sidebar .nav-section-header {
                display: block;
            }
            #sidebar .nav-divider {
                margin: 0.75rem 0.75rem;
            }
            #sidebar .nav-icon-btn {
                justify-content: flex-start;
                padding: 0 1rem;
                width: 100%;
                height: 44px;
                border-radius: 8px;
            }
            #sidebar .nav-icon-btn.active::before {
                display: block;
            }
            #input-panel {
                display: flex !important;
                width: 350px !important;
                min-width: 320px;
                max-width: 400px;
            }
            #result-panel {
                display: flex !important;
                flex: 1 1 0%;
                min-width: 400px;
            }
            .hamburger-btn {
                display: none !important;
            }
        }

        /* ========== lg (1024px ~ 1279px): Sidebar collapsed (icons only), 2-column maintained ========== */
        @media (min-width: 1024px) and (max-width: 1279px) {
            .mobile-tab-bar {
                display: none !important;
            }
            #mobile-bottom-nav {
                display: none !important;
            }
            /* Collapsed sidebar - icons only */
            #sidebar {
                width: 64px !important;
                min-width: 64px;
                max-width: 64px;
                position: static;
                transform: none;
            }
            #sidebar .sidebar-header {
                justify-content: center;
                padding: 0;
            }
            #sidebar .sidebar-title {
                display: none;
            }
            #sidebar .nav-icon-btn {
                justify-content: center;
                padding: 0;
                width: 44px;
                height: 44px;
                margin: 0 auto;
                border-radius: 12px;
            }
            #sidebar .nav-label {
                display: none;
            }
            #sidebar .nav-section-header {
                display: none;
            }
            #sidebar .nav-divider {
                margin: 0.5rem auto;
                width: 32px;
            }
            #sidebar .p-3 {
                padding: 0.5rem !important;
            }
            /* Hide active indicator bar in collapsed mode */
            #sidebar .nav-icon-btn.active::before {
                display: none;
            }
            /* Centered active state for collapsed mode */
            #sidebar .nav-icon-btn.active {
                background: rgba(15, 117, 138, 0.2);
            }
            /* Tooltip on hover for collapsed sidebar */
            #sidebar .nav-icon-btn {
                position: relative;
            }
            #sidebar .nav-icon-btn::after {
                content: attr(title);
                position: absolute;
                left: calc(100% + 12px);
                top: 50%;
                transform: translateY(-50%);
                background: var(--surface-dark);
                color: var(--text-primary);
                padding: 8px 12px;
                border-radius: 8px;
                font-size: 12px;
                font-weight: 500;
                white-space: nowrap;
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.2s, transform 0.2s;
                z-index: 100;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                border: 1px solid var(--border-dark);
            }
            #sidebar .nav-icon-btn:hover::after {
                opacity: 1;
                transform: translateY(-50%) translateX(4px);
            }
            /* Input panel slightly narrower */
            #input-panel {
                display: flex !important;
                width: 320px !important;
                min-width: 280px;
                max-width: 350px;
            }
            #result-panel {
                display: flex !important;
                flex: 1 1 0%;
                min-width: 350px;
            }
            .hamburger-btn {
                display: none !important;
            }
        }

        /* ========== md (768px ~ 1023px): Sidebar hidden, hamburger menu, 2-column layout ========== */
        @media (min-width: 768px) and (max-width: 1023px) {
            .mobile-tab-bar {
                display: none !important;
            }
            #mobile-bottom-nav {
                display: none !important;
            }
            /* Sidebar off-canvas */
            #sidebar {
                position: fixed;
                left: 0;
                top: 0;
                height: 100%;
                width: 240px !important;
                min-width: 240px;
                max-width: 240px;
                transform: translateX(-100%);
                transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                z-index: 100;
                box-shadow: 4px 0 24px rgba(0, 0, 0, 0.3);
            }
            #sidebar.sidebar-open {
                transform: translateX(0);
            }
            #sidebar .sidebar-title {
                display: block;
            }
            #sidebar .nav-label {
                display: inline;
            }
            #sidebar .nav-section-header {
                display: block;
            }
            #sidebar .nav-divider {
                margin: 0.75rem 0.75rem;
            }
            #sidebar .nav-icon-btn {
                justify-content: flex-start;
                padding: 0 var(--spacing-md);
            }
            /* Show hamburger button */
            .hamburger-btn {
                display: flex !important;
            }
            /* Main container takes full width */
            .main-container {
                width: 100%;
            }
            /* 2-column layout maintained */
            #input-panel {
                display: flex !important;
                width: 300px !important;
                min-width: 260px;
                max-width: 320px;
            }
            #result-panel {
                display: flex !important;
                flex: 1 1 0%;
                min-width: 300px;
            }
        }

        /* ========== sm (< 768px): Single column, tab navigation ========== */
        @media (max-width: 767px) {
            /* Hide mobile-bottom-nav, use mobile-tab-bar instead */
            #mobile-bottom-nav {
                display: none !important;
            }
            /* Show mobile tab bar */
            .mobile-tab-bar {
                display: flex !important;
            }
            /* Sidebar off-canvas */
            #sidebar {
                position: fixed;
                left: 0;
                top: 0;
                height: 100%;
                width: 280px !important;
                min-width: 280px;
                max-width: 280px;
                transform: translateX(-100%);
                transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                z-index: 100;
                box-shadow: 4px 0 24px rgba(0, 0, 0, 0.3);
            }
            #sidebar.sidebar-open {
                transform: translateX(0);
            }
            #sidebar .sidebar-title {
                display: block;
            }
            #sidebar .nav-label {
                display: inline;
            }
            #sidebar .nav-section-header {
                display: block;
            }
            #sidebar .nav-divider {
                margin: 0.75rem 0.75rem;
            }
            /* Show hamburger button */
            .hamburger-btn {
                display: flex !important;
            }
            /* Single column layout */
            .content-area,
            #main-content {
                flex-direction: column;
            }
            /* Panels stack and toggle visibility via tabs */
            #input-panel,
            #result-panel {
                width: 100% !important;
                min-width: 100% !important;
                max-width: 100% !important;
                border-right: none;
            }
            #input-panel {
                display: none !important;
                border-bottom: 1px solid var(--border-dark);
            }
            #result-panel {
                display: none !important;
                padding-bottom: 60px; /* Space for tab bar */
            }
            #input-panel.active {
                display: flex !important;
            }
            #result-panel.active {
                display: flex !important;
            }
            /* Content padding for tab bar */
            #main-content {
                padding-bottom: calc(56px + env(safe-area-inset-bottom, 0px));
            }
            /* Header adjustments */
            header.h-14 {
                height: 52px !important;
            }
            header .px-6 {
                padding-left: 0.75rem !important;
                padding-right: 0.75rem !important;
            }
            /* Hide usage display to save space */
            #usage-display-header {
                display: none;
            }
            /* Smaller provider badge */
            #provider-badge-header {
                padding: 0.25rem 0.5rem !important;
            }
            /* Compact input sections */
            #input-panel .p-4 {
                padding: 0.75rem !important;
            }
            /* Touch targets */
            button, [role="button"], label.cursor-pointer, a {
                min-height: 44px;
                min-width: 44px;
            }
            .style-card {
                min-height: 44px;
            }
            /* Modal as bottom sheet */
            .modal-overlay .modal-content {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                max-width: 100%;
                width: 100%;
                max-height: 90vh;
                border-radius: 20px 20px 0 0;
                animation: slideUp 0.3s ease-out;
            }
            @keyframes slideUp {
                from {
                    transform: translateY(100%);
                    opacity: 0;
                }
                to {
                    transform: translateY(0);
                    opacity: 1;
                }
            }
            .modal-content::before {
                content: '';
                display: block;
                width: 36px;
                height: 4px;
                background: rgba(255, 255, 255, 0.2);
                border-radius: 2px;
                margin: 8px auto 4px;
            }
            /* Tap feedback */
            button:active, [role="button"]:active, label.cursor-pointer:active {
                opacity: 0.7;
            }
            /* Footer buttons wrap */
            .report-card .card-footer .flex.items-center.gap-1 {
                flex-wrap: wrap;
                justify-content: center;
                gap: 4px;
            }
            .report-card .card-footer button {
                flex: 0 0 auto;
                padding: 8px 10px;
            }
        }

        /* ========== xs (< 375px): Extra compact for very small screens ========== */
        @media (max-width: 374px) {
            header.h-14 {
                height: 48px !important;
            }
            #provider-badge-header {
                display: none;
            }
            #input-panel .p-4 {
                padding: 0.5rem !important;
            }
            .mobile-tab-bar {
                height: 52px;
            }
            .style-card {
                padding: 10px;
            }
            .report-card .card-footer button span:last-child {
                display: none;
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Safe area for notched devices */
        @supports (padding-bottom: env(safe-area-inset-bottom)) {
            body {
                padding-bottom: env(safe-area-inset-bottom);
            }
            .modal-content {
                padding-bottom: calc(16px + env(safe-area-inset-bottom));
            }
        }

        /* ==================== Sidebar Navigation System ==================== */

        /* Navigation Buttons - Enhanced Visual Design */
        .nav-icon-btn {
            position: relative;
            width: 100%;
            height: 44px;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0 1rem;
            border-radius: 8px;
            color: var(--text-muted);
            transition: all 0.2s ease;
            cursor: pointer;
            border: none;
            background: transparent;
            text-align: left;
        }

        /* Hover state */
        .nav-icon-btn:hover {
            background: var(--surface-dark);
            color: var(--text-primary);
        }

        /* Active state with left indicator */
        .nav-icon-btn.active {
            background: rgba(15, 117, 138, 0.12);
            color: var(--primary);
        }

        /* Active indicator bar */
        .nav-icon-btn.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 24px;
            background: var(--primary);
            border-radius: 0 3px 3px 0;
        }

        /* Focus state for keyboard navigation */
        .nav-icon-btn:focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: -2px;
        }

        /* Icon styling */
        .nav-icon-btn .material-symbols-outlined {
            font-size: 20px;
            flex-shrink: 0;
            transition: transform 0.2s ease;
        }

        .nav-icon-btn:hover .material-symbols-outlined {
            transform: scale(1.05);
        }

        /* Label styling */
        .nav-icon-btn .nav-label {
            font-size: 13px;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Navigation group divider */
        .nav-divider {
            height: 1px;
            margin: 0.5rem 0.75rem;
            background: var(--border-dark);
        }

        /* Navigation section header */
        .nav-section-header {
            padding: 0.5rem 1rem;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            opacity: 0.7;
        }

        /* Badge for menu items */
        .nav-badge {
            margin-left: auto;
            padding: 2px 6px;
            font-size: 10px;
            font-weight: 600;
            border-radius: 10px;
            background: var(--primary);
            color: white;
        }

        /* Light mode adjustments */
        [data-theme="light"] .nav-icon-btn:hover {
            background: var(--bg-elevated);
        }

        [data-theme="light"] .nav-icon-btn.active {
            background: rgba(15, 117, 138, 0.08);
        }

        /* 패널 뷰 전환 */
        .panel-view {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        .panel-view.hidden {
            display: none;
        }

        /* 히스토리 아이템 */
        .history-item {
            background: var(--card-dark);
            border: 1px solid var(--card-border);
            border-radius: 0.75rem;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            overflow: hidden;
            min-width: 0;
        }
        .history-item:hover {
            border-color: var(--primary);
            transform: translateY(-1px);
        }
        .history-item-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            gap: 0.5rem;
        }
        .history-item-meta {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
            color: var(--text-muted);
            flex-wrap: wrap;
            min-width: 0;
            flex: 1;
        }
        .history-item-title {
            font-size: 0.9375rem;
            font-weight: 600;
            color: white;
            margin-bottom: 0.25rem;
            line-height: 1.4;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        .history-item-url {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }
        .history-item-preview {
            font-size: 0.8125rem;
            color: #9ca3af;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            word-break: break-word;
        }
        .history-delete-btn {
            padding: 0.25rem;
            color: var(--text-muted);
            transition: color 0.2s;
        }
        .history-delete-btn:hover {
            color: #ef4444;
        }

        /* Usage 차트 */
        .weekly-bar {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            gap: 0.25rem;
            height: 100%;
        }
        .weekly-bar-fill {
            width: 100%;
            max-width: 2rem;
            min-height: 4px;
            background: var(--primary);
            border-radius: 0.25rem 0.25rem 0 0;
            transition: height 0.3s;
        }
        .weekly-bar-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            flex-shrink: 0;
        }
        .weekly-bar-value {
            font-size: 0.75rem;
            color: white;
            font-weight: 500;
            flex-shrink: 0;
        }

        .style-stat-row {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .style-stat-label {
            width: 4.5rem;
            font-size: 0.75rem;
            color: white;
            flex-shrink: 0;
        }
        .style-stat-bar-bg {
            flex: 1;
            height: 0.5rem;
            background: var(--background-dark);
            border-radius: 0.25rem;
            overflow: hidden;
        }
        .style-stat-bar-fill {
            height: 100%;
            background: var(--primary);
            border-radius: 0.25rem;
            transition: width 0.3s;
        }
        .style-stat-value {
            width: 5rem;
            font-size: 0.75rem;
            color: var(--text-muted);
            text-align: right;
            flex-shrink: 0;
        }

        /* ==================== Panel Resize Handle ==================== */

        /* 리사이즈 핸들 기본 스타일 */
        .resize-handle {
            position: absolute;
            right: -3px;
            top: 0;
            width: 6px;
            height: 100%;
            cursor: col-resize;
            z-index: 100;
            background: transparent;
            transition: background-color 0.15s ease;
        }

        /* 호버 시 핸들 배경 */
        .resize-handle:hover {
            background: linear-gradient(to right,
                transparent 0%,
                rgba(173, 43, 238, 0.1) 50%,
                transparent 100%);
        }

        /* 활성 상태 핸들 */
        .resize-handle.active {
            background: linear-gradient(to right,
                transparent 0%,
                rgba(173, 43, 238, 0.2) 50%,
                transparent 100%);
        }

        /* 그립 라인 (핸들 중앙 시각적 표시) */
        .resize-handle-grip {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 2px;
            height: 40px;
            background: var(--border-dark);
            border-radius: 2px;
            opacity: 0;
            transition: opacity 0.15s ease, background-color 0.15s ease, height 0.15s ease;
        }

        /* 핸들 호버 시 그립 표시 */
        .resize-handle:hover .resize-handle-grip {
            opacity: 1;
            background: var(--color-primary);
            height: 60px;
        }

        /* 핸들 활성 시 그립 스타일 */
        .resize-handle.active .resize-handle-grip {
            opacity: 1;
            background: var(--color-primary);
            height: 80px;
            box-shadow: 0 0 8px rgba(173, 43, 238, 0.5);
        }

        /* 핸들 포커스 상태 (키보드 접근성) */
        .resize-handle:focus {
            outline: none;
        }

        .resize-handle:focus .resize-handle-grip {
            opacity: 1;
            background: var(--color-primary);
            box-shadow: 0 0 0 2px rgba(173, 43, 238, 0.3);
        }

        /* 리사이즈 중 body 스타일 */
        body.resizing {
            cursor: col-resize !important;
            user-select: none !important;
            -webkit-user-select: none !important;
        }

        body.resizing * {
            cursor: col-resize !important;
        }

        /* input-panel에 position relative 추가 (핸들 위치 기준) */
        #input-panel {
            position: relative;
        }

        /* 리사이즈 가능 상태 표시 (xl 이상에서만) */
        @media (min-width: 1280px) {
            #input-panel {
                transition: width 0.05s ease-out;
            }

            /* 핸들이 보이도록 패널 overflow 조정 */
            #input-panel {
                overflow: visible;
            }

            #input-panel > *:not(.resize-handle) {
                overflow-y: auto;
            }
        }

        /* xl 미만에서는 핸들 숨김 */
        @media (max-width: 1279px) {
            .resize-handle {
                display: none !important;
            }
        }

        /* ==================== US-013: 키보드 네비게이션 스타일 ==================== */

        /* 키보드 네비게이션 모드 감지 */
        body.keyboard-navigation *:focus {
            outline: 2px solid var(--primary, #0f758a) !important;
            outline-offset: 2px !important;
        }

        body.mouse-navigation *:focus:not(:focus-visible) {
            outline: none !important;
        }

        /* focus-visible 기본 스타일 강화 */
        :focus-visible {
            outline: 2px solid var(--primary, #0f758a);
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(15, 117, 138, 0.2);
        }

        /* 버튼 focus-visible */
        button:focus-visible,
        [role="button"]:focus-visible {
            outline: 2px solid var(--primary, #0f758a);
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(15, 117, 138, 0.25);
        }

        /* 입력 필드 focus-visible */
        input:focus-visible,
        select:focus-visible,
        textarea:focus-visible {
            outline: none;
            border-color: var(--primary, #0f758a);
            box-shadow: 0 0 0 3px rgba(15, 117, 138, 0.2);
        }

        /* 링크 focus-visible */
        a:focus-visible {
            outline: 2px solid var(--primary, #0f758a);
            outline-offset: 2px;
            border-radius: 4px;
        }

        /* 스타일 카드 focus-visible */
        .style-card:focus-visible,
        label.style-grid-item input:focus-visible + .style-card,
        label.style-grid-item:focus-within .style-card {
            outline: 2px solid var(--primary, #0f758a);
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(15, 117, 138, 0.2);
        }

        /* 라디오/체크박스 라벨 focus-within */
        label.cursor-pointer:focus-within {
            outline: 2px solid var(--primary, #0f758a);
            outline-offset: 2px;
            border-radius: 8px;
        }

        /* 모디파이어 칩 focus-visible */
        .modifier-chip:focus-within .chip-content,
        label.modifier-chip input:focus-visible + .chip-content {
            outline: 2px solid var(--primary, #0f758a);
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(15, 117, 138, 0.2);
        }

        /* 사이드바 버튼 focus-visible */
        .nav-icon-btn:focus-visible {
            outline: 2px solid var(--primary, #0f758a);
            outline-offset: -2px;
            background: rgba(15, 117, 138, 0.15);
        }

        /* 모달 닫기 버튼 focus-visible */
        .modal-close-btn:focus-visible {
            outline: 2px solid var(--primary, #0f758a);
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(15, 117, 138, 0.2);
        }

        /* 복사 버튼 focus-visible */
        .card-copy-btn:focus-visible {
            outline: 2px solid var(--primary, #0f758a);
            outline-offset: 2px;
        }

        /* 드롭다운 select focus-visible */
        select:focus-visible {
            border-color: var(--primary, #0f758a);
            box-shadow: 0 0 0 3px rgba(15, 117, 138, 0.2);
        }

        /* sr-only 라디오/체크박스도 focus 시 부모 스타일 적용 */
        input.sr-only:focus-visible {
            position: absolute;
            width: 1px;
            height: 1px;
        }

        /* Skip link 스타일 개선 */
        .skip-link {
            position: absolute;
            top: -100px;
            left: 16px;
            background: var(--primary, #0f758a);
            color: #ffffff;
            padding: 12px 24px;
            border-radius: 8px;
            z-index: 9999;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: top 0.2s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .skip-link:focus {
            top: 16px;
            outline: 2px solid #ffffff;
            outline-offset: 2px;
        }

        /* 포커스 링 애니메이션 (키보드 네비게이션 시에만) */
        body.keyboard-navigation *:focus-visible {
            animation: focusPulse 0.3s ease-out;
        }

        @keyframes focusPulse {
            0% {
                box-shadow: 0 0 0 0 rgba(15, 117, 138, 0.4);
            }
            100% {
                box-shadow: 0 0 0 4px rgba(15, 117, 138, 0.2);
            }
        }

        /* 키보드로 선택된 요소 하이라이트 */
        .keyboard-selected {
            outline: 2px solid var(--primary, #0f758a) !important;
            outline-offset: 2px !important;
        }

        /* 모달 내 포커스 트랩 시각적 표시 */
        .modal-overlay.active .modal-content:focus-within {
            box-shadow: 0 0 0 2px rgba(15, 117, 138, 0.3),
                        0 24px 64px rgba(0, 0, 0, 0.6);
        }

        /* 카드 액션 버튼 그룹 focus-visible */
        .result-card-actions button:focus-visible {
            outline: 2px solid var(--primary, #0f758a);
            outline-offset: 2px;
            background: rgba(15, 117, 138, 0.1);
        }

        /* 히스토리/사용량 뷰 버튼 focus-visible */
        #history-view button:focus-visible,
        #usage-view button:focus-visible {
            outline: 2px solid var(--primary, #0f758a);
            outline-offset: 2px;
        }

        /* 고대비 모드 지원 */
        @media (prefers-contrast: high) {
            :focus-visible {
                outline: 3px solid currentColor !important;
                outline-offset: 3px !important;
            }
        }

        /* 모션 감소 모드에서 포커스 애니메이션 제거 */
        @media (prefers-reduced-motion: reduce) {
            body.keyboard-navigation *:focus-visible {
                animation: none;
            }
        }

    </style>
</head>
<body class="bg-background-dark text-text-light font-body overflow-hidden h-screen flex selection:bg-primary/30 selection:text-white">
    <!-- Skip Link for Keyboard Users -->
    <a href="#main-content" class="skip-link">메인 콘텐츠로 건너뛰기</a>

    <!-- ==================== Sidebar (200px) ==================== -->
    <aside id="sidebar" class="flex flex-col bg-background-dark flex-shrink-0 h-full z-50" role="complementary" aria-label="사이드바 네비게이션">
        <!-- Logo Area with Title -->
        <div class="sidebar-header">
            <div class="sidebar-logo rounded-lg bg-primary flex items-center justify-center">
                <span class="material-symbols-outlined text-white text-base" aria-hidden="true">auto_awesome_motion</span>
            </div>
            <span class="sidebar-title">Insight Engine</span>
        </div>

        <!-- Main Navigation -->
        <nav class="flex-1 flex flex-col p-3" aria-label="주요 메뉴">
            <!-- Primary Navigation Group -->
            <div class="nav-section-header" id="nav-main-label">메인</div>
            <div class="flex flex-col gap-1" role="group" aria-labelledby="nav-main-label">
                <button class="nav-icon-btn active" data-section="dashboard" title="Dashboard" aria-current="page" tabindex="0">
                    <span class="material-symbols-outlined" aria-hidden="true">dashboard</span>
                    <span class="nav-label">대시보드</span>
                </button>
                <button class="nav-icon-btn" data-section="history" title="History" tabindex="0">
                    <span class="material-symbols-outlined" aria-hidden="true">history</span>
                    <span class="nav-label">히스토리</span>
                </button>
                <button class="nav-icon-btn" data-section="usage" title="Usage" tabindex="0">
                    <span class="material-symbols-outlined" aria-hidden="true">pie_chart</span>
                    <span class="nav-label">사용량</span>
                </button>
            </div>

            <!-- Divider -->
            <div class="nav-divider" role="separator"></div>

            <!-- Settings Group -->
            <div class="nav-section-header" id="nav-settings-label">설정</div>
            <div class="flex flex-col gap-1" role="group" aria-labelledby="nav-settings-label">
                <button id="sidebar-settings-btn" class="nav-icon-btn" title="Settings" tabindex="0" aria-label="환경설정 열기">
                    <span class="material-symbols-outlined" aria-hidden="true">settings</span>
                    <span class="nav-label">환경설정</span>
                </button>
            </div>
        </nav>

        <!-- User Profile / Auth (Bottom) -->
        <div class="p-3 border-t border-border-dark">
            <button id="sidebar-auth-container" class="nav-icon-btn" title="로그인" aria-label="로그인">
                <span class="material-symbols-outlined" aria-hidden="true">person</span>
                <span class="nav-label">로그인</span>
            </button>
        </div>
    </aside>

    <!-- Mobile Sidebar Overlay -->
    <div id="sidebar-overlay"></div>

    <!-- ==================== Main Content Area (3-Column Layout) ==================== -->
    <div class="main-container">
        <!-- Top Bar (Header) -->
        <header class="h-14 flex items-center justify-between px-6 border-b border-border-dark bg-background-dark flex-shrink-0" role="banner" aria-label="상단 헤더">
            <!-- Left: Hamburger + Version Badge -->
            <div class="flex items-center gap-3">
                <!-- Hamburger Menu Button (visible on md and below) -->
                <button class="hamburger-btn" id="hamburger-btn" aria-label="메뉴 열기" aria-expanded="false" aria-controls="sidebar" onclick="toggleSidebar()">
                    <span class="material-symbols-outlined" aria-hidden="true">menu</span>
                </button>
                <span class="px-2 py-0.5 rounded text-[10px] font-bold bg-surface-dark text-primary">Beta v2.5</span>
            </div>

            <!-- Right: Usage Display + Provider Badge + Actions -->
            <div class="flex items-center gap-3">
                <!-- Usage Display -->
                <div id="usage-display-header" class="flex items-center gap-2 px-3 py-1.5 bg-surface-dark rounded-lg text-xs" role="status" aria-label="사용량 현황" aria-live="polite">
                    <span class="material-symbols-outlined text-primary text-sm" aria-hidden="true">bolt</span>
                    <span class="text-text-secondary">
                        <span id="header-usage-count" aria-label="현재 사용량">-</span> / <span id="header-usage-limit" aria-label="일일 제한">-</span>
                    </span>
                </div>

                <!-- AI Provider Badge -->
                <div id="provider-badge-header" class="flex items-center gap-2 px-3 py-1.5 bg-surface-dark rounded-lg cursor-pointer hover:bg-bg-elevated transition-colors" role="status" aria-label="현재 AI 서비스">
                    <span class="text-primary text-[10px] font-bold" aria-hidden="true">AI</span>
                    <span class="text-xs text-text-secondary" id="current-provider-label">미설정</span>
                </div>

                <!-- Theme Toggle Button -->
                <button id="theme-toggle-btn" class="relative flex items-center justify-center cursor-pointer text-text-secondary hover:text-primary transition-colors p-2 rounded-lg hover:bg-surface-dark group" aria-label="테마 전환">
                    <span class="material-symbols-outlined text-lg" aria-hidden="true">contrast</span>
                    <span class="theme-tooltip absolute top-full mt-1 px-2 py-1 bg-surface-dark text-xs text-text-secondary rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none z-50">시스템 설정</span>
                </button>

                <!-- Settings Button -->
                <button id="settings-btn" class="flex items-center gap-1.5 cursor-pointer text-text-secondary hover:text-primary transition-colors p-2 rounded-lg hover:bg-surface-dark" aria-label="설정 열기" aria-haspopup="dialog">
                    <span class="material-symbols-outlined text-lg" aria-hidden="true">settings</span>
                </button>

                <!-- Auth Container -->
                <div id="auth-container" class="flex items-center"></div>
            </div>
        </header>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settings-modal" role="dialog" aria-modal="true" aria-labelledby="settings-modal-title">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h2 id="settings-modal-title" class="text-xl font-bold flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary" aria-hidden="true">settings</span>
                    설정
                </h2>
                <button id="modal-close" class="modal-close-btn" aria-label="설정 닫기" title="닫기 (ESC)">
                    <span class="material-symbols-outlined" aria-hidden="true">close</span>
                </button>
            </div>

            <!-- AI Services Section -->
            <div class="mb-6">
                <h3 class="font-bold mb-3 flex items-center gap-2 text-sm">
                    <span class="material-symbols-outlined text-primary" aria-hidden="true">smart_toy</span>
                    AI 서비스
                </h3>
                <div id="provider-list" class="space-y-3 max-h-[40vh] overflow-y-auto">
                    <!-- Provider list will be dynamically generated -->
                </div>
            </div>

            <!-- Cache Management Section -->
            <div class="pt-4 border-t border-border-dark/50">
                <h3 class="font-bold mb-3 flex items-center gap-2 text-sm">
                    <span class="material-symbols-outlined text-orange-400" aria-hidden="true">cached</span>
                    캐시 관리
                </h3>
                <p class="text-xs text-text-subtle mb-3 font-body">
                    저장된 자막/댓글 캐시를 삭제합니다. 같은 영상을 새로 분석하려면 캐시를 삭제하세요.
                </p>
                <button type="button" id="clear-cache-btn" class="w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-red-500/10 border border-red-500/30 text-red-400 hover:bg-red-500/20 hover:border-red-500/50 transition-all rounded-lg text-sm font-medium" aria-describedby="cache-description">
                    <span class="material-symbols-outlined text-base" aria-hidden="true">delete</span>
                    <span>전체 캐시 삭제</span>
                </button>
                <span id="cache-description" class="sr-only">저장된 자막과 댓글 캐시를 모두 삭제합니다</span>
            </div>

            <div class="flex justify-end gap-3 mt-6 pt-4 border-t border-border-dark/50">
                <button id="modal-cancel" class="px-6 py-2 text-sm font-bold bg-primary text-black hover:bg-white transition-colors rounded-lg">닫기</button>
            </div>
        </div>
    </div>

    <!-- Custom Style Modal -->
    <div class="modal-overlay" id="custom-style-modal" role="dialog" aria-modal="true" aria-labelledby="custom-style-modal-heading">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h2 id="custom-style-modal-heading" class="text-xl font-bold flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary" aria-hidden="true">edit_note</span>
                    <span id="custom-style-modal-title">새 스타일 만들기</span>
                </h2>
                <button id="custom-style-modal-close" class="modal-close-btn" aria-label="스타일 편집 닫기" title="닫기 (ESC)">
                    <span class="material-symbols-outlined" aria-hidden="true">close</span>
                </button>
            </div>

            <div class="space-y-4">
                <!-- Style Name -->
                <div>
                    <label class="block text-xs font-mono text-text-subtle mb-2 uppercase">스타일 이름</label>
                    <input type="text" id="custom-style-name" maxlength="20" placeholder="예: 내 분석 스타일" class="w-full bg-black border border-border-dark text-white p-3 focus:border-primary focus:outline-none"/>
                </div>

                <!-- Icon Selection -->
                <div>
                    <label class="block text-xs font-mono text-text-subtle mb-2 uppercase">아이콘 선택</label>
                    <div class="grid grid-cols-5 gap-2" id="icon-selection">
                        <label class="cursor-pointer">
                            <input type="radio" name="custom-icon" value="edit_note" checked class="peer sr-only"/>
                            <div class="border border-border-dark bg-black p-3 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-gray-500 transition-all">
                                <span class="material-symbols-outlined text-text-subtle peer-checked:text-primary">edit_note</span>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="radio" name="custom-icon" value="star" class="peer sr-only"/>
                            <div class="border border-border-dark bg-black p-3 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-gray-500 transition-all">
                                <span class="material-symbols-outlined text-text-subtle peer-checked:text-primary">star</span>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="radio" name="custom-icon" value="bookmark" class="peer sr-only"/>
                            <div class="border border-border-dark bg-black p-3 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-gray-500 transition-all">
                                <span class="material-symbols-outlined text-text-subtle peer-checked:text-primary">bookmark</span>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="radio" name="custom-icon" value="psychology" class="peer sr-only"/>
                            <div class="border border-border-dark bg-black p-3 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-gray-500 transition-all">
                                <span class="material-symbols-outlined text-text-subtle peer-checked:text-primary">psychology</span>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="radio" name="custom-icon" value="rocket_launch" class="peer sr-only"/>
                            <div class="border border-border-dark bg-black p-3 text-center peer-checked:border-primary peer-checked:bg-primary/10 hover:border-gray-500 transition-all">
                                <span class="material-symbols-outlined text-text-subtle peer-checked:text-primary">rocket_launch</span>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Prompt -->
                <div>
                    <label class="block text-xs font-mono text-text-subtle mb-2 uppercase">프롬프트</label>
                    <textarea id="custom-style-prompt" maxlength="2000" rows="8" placeholder="AI에게 전달할 지시사항을 작성하세요.&#10;&#10;예:&#10;당신은 마케팅 전문가입니다.&#10;아래 영상의 내용을 분석하여 마케팅 인사이트를 도출해주세요.&#10;- 타겟 고객층&#10;- 핵심 메시지&#10;- 활용 가능한 채널" class="w-full bg-black border border-border-dark text-white p-3 focus:border-primary focus:outline-none resize-none font-mono text-sm"></textarea>
                    <div class="text-right text-xs text-text-subtle mt-1">
                        <span id="prompt-char-count">0</span>/2000자
                    </div>
                </div>
            </div>

            <div class="flex justify-between gap-3 mt-6 pt-4 border-t border-border-dark/50">
                <button id="custom-style-delete" class="px-4 py-2 text-sm font-bold text-red-500 hover:text-red-400 hover:bg-red-500/10 transition-colors hidden">삭제</button>
                <div class="flex gap-3 ml-auto">
                    <button id="custom-style-cancel" class="px-4 py-2 text-sm font-bold text-text-subtle hover:text-white transition-colors">취소</button>
                    <button id="custom-style-save" class="px-6 py-2 text-sm font-bold bg-primary text-black hover:bg-white transition-colors">저장</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal-overlay" id="auth-modal" role="dialog" aria-modal="true" aria-labelledby="auth-modal-title">
        <div class="modal-content p-6" style="max-width: 400px;">
            <div class="flex items-center justify-between mb-6">
                <h2 id="auth-modal-title" class="text-xl font-bold flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary" aria-hidden="true">person</span>
                    로그인 / 회원가입
                </h2>
                <button id="auth-modal-close" class="modal-close-btn" aria-label="로그인 창 닫기" title="닫기 (ESC)">
                    <span class="material-symbols-outlined" aria-hidden="true">close</span>
                </button>
            </div>

            <!-- Tabs -->
            <div class="flex border-b border-border-dark mb-6">
                <button id="auth-login-tab" class="flex-1 py-3 text-sm font-medium border-b-2 border-primary text-primary transition-colors">
                    로그인
                </button>
                <button id="auth-signup-tab" class="flex-1 py-3 text-sm font-medium border-b-2 border-transparent text-text-subtle hover:text-white transition-colors">
                    회원가입
                </button>
            </div>

            <!-- Login Form -->
            <div id="auth-login-form" class="space-y-4">
                <div>
                    <label class="block text-xs text-text-subtle mb-2">이메일</label>
                    <input type="email" id="login-email" class="w-full bg-background-dark border border-border-dark rounded-lg px-4 py-3 text-sm text-warm-white focus:border-primary focus:outline-none transition-colors" placeholder="your@email.com">
                </div>
                <div>
                    <label class="block text-xs text-text-subtle mb-2">비밀번호</label>
                    <input type="password" id="login-password" class="w-full bg-background-dark border border-border-dark rounded-lg px-4 py-3 text-sm text-warm-white focus:border-primary focus:outline-none transition-colors" placeholder="••••••••">
                </div>
                <button id="auth-login-submit" class="w-full bg-gradient-to-r from-primary to-primary-glow text-background-dark font-semibold py-3 rounded-lg hover:opacity-90 transition-opacity">
                    로그인
                </button>
                <button id="show-reset-password" class="w-full text-xs text-text-subtle hover:text-primary transition-colors py-2">
                    비밀번호를 잊으셨나요?
                </button>

                <!-- 소셜 로그인 구분선 -->
                <div class="flex items-center gap-3 my-4">
                    <div class="flex-1 h-px bg-border-dark"></div>
                    <span class="text-xs text-text-subtle">또는</span>
                    <div class="flex-1 h-px bg-border-dark"></div>
                </div>

                <!-- 소셜 로그인 버튼 -->
                <button id="google-login-btn" class="w-full flex items-center justify-center gap-2 bg-white text-gray-800 font-medium py-3 rounded-lg hover:bg-gray-100 transition-colors">
                    <svg class="w-5 h-5" viewBox="0 0 24 24">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    Google로 로그인
                </button>
            </div>

            <!-- Signup Form -->
            <div id="auth-signup-form" class="space-y-4 hidden">
                <div>
                    <label class="block text-xs text-text-subtle mb-2">이메일</label>
                    <input type="email" id="signup-email" class="w-full bg-background-dark border border-border-dark rounded-lg px-4 py-3 text-sm text-warm-white focus:border-primary focus:outline-none transition-colors" placeholder="your@email.com">
                </div>
                <div>
                    <label class="block text-xs text-text-subtle mb-2">비밀번호</label>
                    <input type="password" id="signup-password" class="w-full bg-background-dark border border-border-dark rounded-lg px-4 py-3 text-sm text-warm-white focus:border-primary focus:outline-none transition-colors" placeholder="6자 이상">
                </div>
                <div>
                    <label class="block text-xs text-text-subtle mb-2">비밀번호 확인</label>
                    <input type="password" id="signup-confirm-password" class="w-full bg-background-dark border border-border-dark rounded-lg px-4 py-3 text-sm text-warm-white focus:border-primary focus:outline-none transition-colors" placeholder="비밀번호 재입력">
                </div>
                <button id="auth-signup-submit" class="w-full bg-gradient-to-r from-primary to-primary-glow text-background-dark font-semibold py-3 rounded-lg hover:opacity-90 transition-opacity">
                    회원가입
                </button>
            </div>

            <!-- Reset Password Form -->
            <div id="auth-reset-form" class="space-y-4 hidden">
                <p class="text-sm text-text-subtle mb-2">
                    가입한 이메일 주소를 입력하시면 비밀번호 재설정 링크를 보내드립니다.
                </p>
                <div>
                    <label class="block text-xs text-text-subtle mb-2">이메일</label>
                    <input type="email" id="reset-email" class="w-full bg-background-dark border border-border-dark rounded-lg px-4 py-3 text-sm text-warm-white focus:border-primary focus:outline-none transition-colors" placeholder="your@email.com">
                </div>
                <button id="auth-reset-submit" class="w-full bg-gradient-to-r from-primary to-primary-glow text-background-dark font-semibold py-3 rounded-lg hover:opacity-90 transition-opacity">
                    재설정 이메일 발송
                </button>
                <button id="back-to-login" class="w-full text-xs text-text-subtle hover:text-primary transition-colors py-2">
                    ← 로그인으로 돌아가기
                </button>
            </div>

            <p class="text-xs text-text-subtle/60 text-center mt-4">
                Supabase 인증 사용
            </p>
        </div>
    </div>

    <!-- Mindmap Modal -->
    <div class="modal-overlay" id="mindmap-modal" role="dialog" aria-modal="true" aria-labelledby="mindmap-modal-title">
        <div class="modal-content" style="max-width: 95vw; max-height: 95vh; width: 1200px;">
            <div class="flex items-center justify-between p-4 border-b border-border-dark/50">
                <h2 id="mindmap-modal-title" class="text-lg font-bold flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary" aria-hidden="true">account_tree</span>
                    <span id="mindmap-title">마인드맵</span>
                </h2>
                <div class="flex items-center gap-2">
                    <button id="mindmap-zoom-in" class="p-2 hover:bg-white/10 text-text-subtle hover:text-white transition-colors rounded" title="확대">
                        <span class="material-symbols-outlined text-sm">zoom_in</span>
                    </button>
                    <button id="mindmap-zoom-out" class="p-2 hover:bg-white/10 text-text-subtle hover:text-white transition-colors rounded" title="축소">
                        <span class="material-symbols-outlined text-sm">zoom_out</span>
                    </button>
                    <button id="mindmap-fit" class="p-2 hover:bg-white/10 text-text-subtle hover:text-white transition-colors rounded" title="화면에 맞추기">
                        <span class="material-symbols-outlined text-sm">fit_screen</span>
                    </button>
                    <div class="h-5 w-px bg-border-dark mx-1"></div>
                    <button id="mindmap-close" class="modal-close-btn" aria-label="마인드맵 닫기" title="닫기 (ESC)">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
            </div>
            <div id="mindmap-container" class="relative bg-black" style="height: calc(95vh - 120px);">
                <!-- Loading state -->
                <div id="mindmap-loading" class="absolute inset-0 flex items-center justify-center">
                    <div class="text-center">
                        <span class="material-symbols-outlined text-4xl text-primary loading-spinner">progress_activity</span>
                        <p class="text-text-subtle mt-3 text-sm">마인드맵 생성 중...</p>
                    </div>
                </div>
                <!-- SVG will be rendered here -->
                <svg id="mindmap-svg" class="w-full h-full"></svg>
            </div>
            <div class="p-3 border-t border-border-dark/50 flex items-center justify-between text-xs text-text-subtle">
                <span id="mindmap-stats"></span>
                <span class="text-text-subtle/50">드래그: 이동 | 스크롤: 확대/축소</span>
            </div>
        </div>
    </div>

    <!-- Prompt Modal (AI 입력 프롬프트 보기) -->
    <div class="modal-overlay" id="prompt-modal">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh;">
            <div class="flex items-center justify-between p-4 border-b border-border-dark/50">
                <h2 class="text-lg font-bold flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary">code</span>
                    <span>AI 입력 프롬프트</span>
                </h2>
                <div class="flex items-center gap-2">
                    <button id="prompt-copy-btn" class="inline-flex items-center gap-1.5 text-xs text-text-subtle hover:text-primary px-3 py-1.5 hover:bg-primary/10 transition-colors rounded-lg" title="복사">
                        <span class="material-symbols-outlined text-sm">content_copy</span>
                        <span>복사</span>
                    </button>
                    <button id="prompt-close" class="modal-close-btn" aria-label="프롬프트 창 닫기" title="닫기 (ESC)">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
            </div>
            <div id="prompt-content" class="p-6 overflow-y-auto font-mono text-sm text-gray-300 leading-relaxed whitespace-pre-wrap bg-black/30" style="max-height: calc(90vh - 120px);">
                <!-- 프롬프트 내용이 여기에 표시됩니다 -->
            </div>
            <div class="p-3 border-t border-border-dark/50 flex items-center justify-between text-xs text-text-subtle">
                <span id="prompt-stats"></span>
                <span class="text-text-subtle/50">스타일 프롬프트 + 자막 + 댓글</span>
            </div>
        </div>
    </div>

    <!-- Onboarding Modal -->
    <div class="modal-overlay" id="onboarding-modal">
        <div class="modal-content p-6">
            <div class="text-center mb-8">
                <div class="w-20 h-20 mx-auto mb-4 bg-gradient-to-br from-primary to-purple-600 flex items-center justify-center rounded-2xl">
                    <span class="material-symbols-outlined text-white text-4xl">smart_display</span>
                </div>
                <h2 class="text-2xl font-bold mb-2">환영합니다!</h2>
                <p class="text-text-subtle font-body">YouTube 영상을 AI로 분석하여<br>요약, 인사이트, 아이디어를 도출합니다.</p>
            </div>
            <div class="mb-6">
                <div id="onboarding-providers" class="space-y-3 max-h-[40vh] overflow-y-auto">
                    <!-- Available services will be dynamically generated -->
                </div>
            </div>
            <button id="onboarding-save" class="w-full bg-primary text-black font-bold py-4 text-lg uppercase tracking-wider hover:bg-white transition-colors flex items-center justify-center gap-2 rounded-xl">
                <span class="material-symbols-outlined">check</span>
                시작하기
            </button>
            <button id="onboarding-skip" class="w-full mt-3 bg-transparent border border-border-dark text-text-subtle font-medium py-3 text-sm hover:border-primary/50 hover:text-white transition-colors flex items-center justify-center gap-2 rounded-xl hidden">
                <span class="material-symbols-outlined text-sm">visibility</span>
                먼저 둘러보기
            </button>
        </div>
    </div>

        <!-- Main Content Area - 3-Column Layout (Input 350px + Result flex-1) -->
        <main id="main-content" class="content-area" role="main" aria-label="메인 콘텐츠 영역">
                <!-- ==================== 입력 패널 (350px) ==================== -->
                <section id="input-panel" class="flex flex-col bg-background-dark" role="region" aria-label="콘텐츠 생성 입력">
                    <!-- Alert Container -->
                    <div id="alert-container" class="px-4 pt-4" role="alert" aria-live="polite"></div>

                    <!-- ===== URL 입력 섹션 ===== -->
                    <fieldset class="p-4 border-b border-border-dark">
                        <legend class="flex items-center gap-2 mb-3">
                            <span class="material-symbols-outlined text-primary text-sm" aria-hidden="true">link</span>
                            <span class="text-sm font-medium text-white">YouTube URL</span>
                        </legend>
                        <!-- URL 입력 필드 - 크기 증가 및 placeholder 개선 -->
                        <div class="flex gap-2">
                            <div class="relative flex-1">
                                <input type="url" id="url-input"
                                       class="w-full bg-surface-dark border border-border-dark rounded-xl px-4 py-3.5 pl-12 text-base text-white placeholder-text-secondary/70 focus:border-primary focus:ring-2 focus:ring-primary/20 focus:outline-none transition-all"
                                       placeholder="YouTube 영상 URL을 붙여넣기 하세요"
                                       aria-label="YouTube 영상 URL 입력"
                                       aria-describedby="url-hint"
                                       autocomplete="off">
                                <div class="absolute left-4 top-1/2 -translate-y-1/2 text-primary" aria-hidden="true">
                                    <span class="material-symbols-outlined text-xl">smart_display</span>
                                </div>
                            </div>
                            <button id="start-btn" class="px-4 py-3.5 bg-primary hover:bg-primary-hover text-white rounded-xl transition-all flex items-center gap-2 font-medium shadow-lg shadow-primary/20 hover:shadow-primary/30" aria-label="URL 목록에 추가">
                                <span class="material-symbols-outlined text-xl" aria-hidden="true">add</span>
                                <span class="text-sm hidden sm:inline">추가</span>
                            </button>
                        </div>
                        <!-- URL 힌트 텍스트 -->
                        <p id="url-hint" class="mt-2 text-xs text-text-secondary/60 flex items-center gap-1">
                            <span class="material-symbols-outlined text-xs" aria-hidden="true">info</span>
                            youtube.com, youtu.be 형식 지원 (최대 10개)
                        </p>
                        <!-- URL 목록 -->
                        <div id="url-list-container" class="mt-3 space-y-1.5 max-h-[150px] overflow-y-auto" role="list" aria-label="추가된 URL 목록" aria-live="polite"></div>
                        <!-- URL 개수 및 AI 자동 분석 -->
                        <div class="flex items-center justify-between mt-3">
                            <span class="text-xs text-text-secondary flex items-center gap-1.5" role="status" aria-label="URL 개수">
                                <span class="material-symbols-outlined text-xs text-primary/60" aria-hidden="true">playlist_add</span>
                                <span id="url-count">0</span>/10 URLs
                            </span>
                            <button id="ai-analyze-btn" class="flex items-center gap-1.5 text-xs text-purple-400 hover:text-purple-300 transition-colors" aria-label="AI 자동 분석: 제목을 분석하여 최적 세팅 후 바로 분석">
                                <span class="material-symbols-outlined text-sm" aria-hidden="true">auto_awesome</span>
                                <span>AI 자동 분석</span>
                            </button>
                        </div>
                    </fieldset>

                    <!-- ===== AI 모델 섹션 ===== -->
                    <fieldset class="p-4 border-b border-border-dark">
                        <legend class="flex items-center gap-2 mb-3">
                            <span class="material-symbols-outlined text-primary text-sm" aria-hidden="true">psychology</span>
                            <span class="text-sm font-medium text-white">AI 모델</span>
                        </legend>
                        <!-- 개선된 드롭다운 - 카드 형태 -->
                        <div class="grid grid-cols-2 gap-3">
                            <!-- 서비스 선택 카드 -->
                            <div class="select-card">
                                <label for="provider" class="block text-[10px] font-semibold text-text-secondary mb-1.5 uppercase tracking-wider">서비스</label>
                                <div class="relative">
                                    <select id="provider" class="w-full bg-surface-dark border border-border-dark rounded-xl px-3 py-2.5 pr-10 text-sm text-white cursor-pointer appearance-none focus:border-primary focus:ring-2 focus:ring-primary/20 focus:outline-none transition-all hover:border-primary/50" aria-describedby="selected-model-info">
                                        <option value="">선택하세요</option>
                                    </select>
                                    <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-primary/60" aria-hidden="true">
                                        <span class="material-symbols-outlined text-lg">unfold_more</span>
                                    </div>
                                </div>
                            </div>
                            <!-- 모델 선택 카드 -->
                            <div class="select-card">
                                <label for="model" class="block text-[10px] font-semibold text-text-secondary mb-1.5 uppercase tracking-wider">모델</label>
                                <div class="relative">
                                    <select id="model" class="w-full bg-surface-dark border border-border-dark rounded-xl px-3 py-2.5 pr-10 text-sm text-white cursor-pointer appearance-none focus:border-primary focus:ring-2 focus:ring-primary/20 focus:outline-none transition-all hover:border-primary/50">
                                        <option value="">선택하세요</option>
                                    </select>
                                    <div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-primary/60" aria-hidden="true">
                                        <span class="material-symbols-outlined text-lg">unfold_more</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- 선택된 모델 정보 표시 -->
                        <div id="selected-model-info" class="mt-3 p-2.5 bg-primary/5 border border-primary/20 rounded-xl hidden" role="status" aria-live="polite">
                            <div class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-primary text-sm" aria-hidden="true">check_circle</span>
                                <span id="selected-model-text" class="text-xs text-text-secondary"></span>
                            </div>
                        </div>
                    </fieldset>

                    <!-- ===== 스타일 섹션 ===== -->
                    <fieldset class="p-4 border-b border-border-dark flex-1 overflow-y-auto">
                        <div class="flex items-center justify-between mb-4">
                            <legend class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-primary text-sm" aria-hidden="true">style</span>
                                <span class="text-sm font-medium text-white">스타일</span>
                            </legend>
                            <!-- 커스텀 스타일 추가 버튼 -->
                            <button id="add-custom-style-btn" class="px-2.5 py-1.5 rounded-lg border border-dashed border-primary/40 text-primary hover:bg-primary/10 text-xs font-medium transition-all flex items-center gap-1" aria-label="커스텀 스타일 추가" aria-haspopup="dialog">
                                <span class="material-symbols-outlined text-sm" aria-hidden="true">add</span>
                                Custom
                            </button>
                        </div>

                        <!-- 스타일 그리드 - 통합 레이아웃 -->
                        <div class="style-grid-container" role="region" aria-label="스타일 선택">
                            <!-- 기본 스타일 카테고리 -->
                            <div class="mb-4">
                                <span id="style-basic-label" class="text-[10px] font-semibold text-text-secondary uppercase tracking-wider mb-2.5 block flex items-center gap-1.5">
                                    <span class="w-1.5 h-1.5 bg-primary rounded-full" aria-hidden="true"></span>
                                    기본
                                </span>
                                <div class="grid grid-cols-4 gap-2" id="style-options" role="radiogroup" aria-labelledby="style-basic-label">
                                    <label class="style-grid-item cursor-pointer group">
                                        <input checked name="style" type="radio" value="blog" class="peer sr-only" aria-describedby="style-blog-desc"/>
                                        <div class="style-card flex flex-col items-center justify-center p-2.5 rounded-xl bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all group-hover:scale-[1.02]">
                                            <span class="material-symbols-outlined text-xl mb-1" aria-hidden="true">edit_note</span>
                                            <span class="text-[10px] font-medium">Blog</span>
                                        </div>
                                        <span id="style-blog-desc" class="sr-only">블로그 포스트 형태로 작성합니다</span>
                                    </label>
                                    <label class="style-grid-item cursor-pointer group">
                                        <input name="style" type="radio" value="summary" class="peer sr-only" aria-describedby="style-summary-desc"/>
                                        <div class="style-card flex flex-col items-center justify-center p-2.5 rounded-xl bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all group-hover:scale-[1.02]">
                                            <span class="material-symbols-outlined text-xl mb-1" aria-hidden="true">description</span>
                                            <span class="text-[10px] font-medium">Summary</span>
                                        </div>
                                        <span id="style-summary-desc" class="sr-only">핵심 내용만 간결하게 요약합니다</span>
                                    </label>
                                    <label class="style-grid-item cursor-pointer group">
                                        <input name="style" type="radio" value="detailed" class="peer sr-only" aria-describedby="style-detailed-desc"/>
                                        <div class="style-card flex flex-col items-center justify-center p-2.5 rounded-xl bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all group-hover:scale-[1.02]">
                                            <span class="material-symbols-outlined text-xl mb-1" aria-hidden="true">article</span>
                                            <span class="text-[10px] font-medium">Detail</span>
                                        </div>
                                        <span id="style-detailed-desc" class="sr-only">상세하고 풍부하게 작성합니다</span>
                                    </label>
                                    <label class="style-grid-item cursor-pointer group">
                                        <input name="style" type="radio" value="easy" class="peer sr-only" aria-describedby="style-easy-desc"/>
                                        <div class="style-card flex flex-col items-center justify-center p-2.5 rounded-xl bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all group-hover:scale-[1.02]">
                                            <span class="material-symbols-outlined text-xl mb-1" aria-hidden="true">forum</span>
                                            <span class="text-[10px] font-medium">Easy</span>
                                        </div>
                                        <span id="style-easy-desc" class="sr-only">누구나 이해하기 쉬운 말로 풀어서 설명합니다</span>
                                    </label>
                                </div>
                            </div>

                            <!-- 분석 스타일 카테고리 -->
                            <div class="mb-4">
                                <span id="style-analysis-label" class="text-[10px] font-semibold text-text-secondary uppercase tracking-wider mb-2.5 block flex items-center gap-1.5">
                                    <span class="w-1.5 h-1.5 bg-amber-500 rounded-full" aria-hidden="true"></span>
                                    분석
                                </span>
                                <div class="grid grid-cols-4 gap-2" id="style-options-analysis" role="radiogroup" aria-labelledby="style-analysis-label">
                                    <label class="style-grid-item cursor-pointer group">
                                        <input name="style" type="radio" value="needs" class="peer sr-only" aria-describedby="style-needs-desc"/>
                                        <div class="style-card flex flex-col items-center justify-center p-2.5 rounded-xl bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all group-hover:scale-[1.02]">
                                            <span class="material-symbols-outlined text-xl mb-1" aria-hidden="true">lightbulb</span>
                                            <span class="text-[10px] font-medium">Ideas</span>
                                        </div>
                                        <span id="style-needs-desc" class="sr-only">영상에서 언급된 니즈와 추천 아이템을 분석합니다</span>
                                    </label>
                                    <label class="style-grid-item cursor-pointer group">
                                        <input name="style" type="radio" value="qna" class="peer sr-only" aria-describedby="style-qna-desc"/>
                                        <div class="style-card flex flex-col items-center justify-center p-2.5 rounded-xl bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all group-hover:scale-[1.02]">
                                            <span class="material-symbols-outlined text-xl mb-1" aria-hidden="true">quiz</span>
                                            <span class="text-[10px] font-medium">Q&A</span>
                                        </div>
                                        <span id="style-qna-desc" class="sr-only">질문과 답변 형식으로 정리합니다</span>
                                    </label>
                                    <label class="style-grid-item cursor-pointer group">
                                        <input name="style" type="radio" value="infographic" class="peer sr-only" aria-describedby="style-info-desc"/>
                                        <div class="style-card flex flex-col items-center justify-center p-2.5 rounded-xl bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all group-hover:scale-[1.02]">
                                            <span class="material-symbols-outlined text-xl mb-1" aria-hidden="true">insert_chart</span>
                                            <span class="text-[10px] font-medium">Info</span>
                                        </div>
                                        <span id="style-info-desc" class="sr-only">인포그래픽 제작에 적합한 핵심 데이터를 추출합니다</span>
                                    </label>
                                    <label class="style-grid-item cursor-pointer group">
                                        <input name="style" type="radio" value="compare" class="peer sr-only" aria-describedby="style-compare-desc"/>
                                        <div class="style-card flex flex-col items-center justify-center p-2.5 rounded-xl bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all group-hover:scale-[1.02]">
                                            <span class="material-symbols-outlined text-xl mb-1" aria-hidden="true">compare</span>
                                            <span class="text-[10px] font-medium">Compare</span>
                                        </div>
                                        <span id="style-compare-desc" class="sr-only">여러 요소를 비교 분석하여 정리합니다</span>
                                    </label>
                                </div>
                            </div>

                            <!-- 콘텐츠 스타일 카테고리 -->
                            <div class="mb-4">
                                <span id="style-content-label" class="text-[10px] font-semibold text-text-secondary uppercase tracking-wider mb-2.5 block flex items-center gap-1.5">
                                    <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full" aria-hidden="true"></span>
                                    콘텐츠
                                </span>
                                <div class="grid grid-cols-4 gap-2" id="style-options-content" role="radiogroup" aria-labelledby="style-content-label">
                                    <label class="style-grid-item cursor-pointer group">
                                        <input name="style" type="radio" value="news" class="peer sr-only" aria-describedby="style-news-desc"/>
                                        <div class="style-card flex flex-col items-center justify-center p-2.5 rounded-xl bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all group-hover:scale-[1.02]">
                                            <span class="material-symbols-outlined text-xl mb-1" aria-hidden="true">newspaper</span>
                                            <span class="text-[10px] font-medium">News</span>
                                        </div>
                                        <span id="style-news-desc" class="sr-only">뉴스 기사 형태로 객관적으로 작성합니다</span>
                                    </label>
                                    <label class="style-grid-item cursor-pointer group">
                                        <input name="style" type="radio" value="script" class="peer sr-only" aria-describedby="style-script-desc"/>
                                        <div class="style-card flex flex-col items-center justify-center p-2.5 rounded-xl bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all group-hover:scale-[1.02]">
                                            <span class="material-symbols-outlined text-xl mb-1" aria-hidden="true">movie</span>
                                            <span class="text-[10px] font-medium">Script</span>
                                        </div>
                                        <span id="style-script-desc" class="sr-only">영상 대본/스크립트 형태로 재구성합니다</span>
                                    </label>
                                    <label class="style-grid-item cursor-pointer group">
                                        <input name="style" type="radio" value="sns" class="peer sr-only" aria-describedby="style-sns-desc"/>
                                        <div class="style-card flex flex-col items-center justify-center p-2.5 rounded-xl bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all group-hover:scale-[1.02]">
                                            <span class="material-symbols-outlined text-xl mb-1" aria-hidden="true">share</span>
                                            <span class="text-[10px] font-medium">SNS</span>
                                        </div>
                                        <span id="style-sns-desc" class="sr-only">SNS 포스팅에 적합한 짧고 임팩트 있는 글을 작성합니다</span>
                                    </label>
                                    <label class="style-grid-item cursor-pointer group">
                                        <input name="style" type="radio" value="seo" class="peer sr-only" aria-describedby="style-seo-desc"/>
                                        <div class="style-card flex flex-col items-center justify-center p-2.5 rounded-xl bg-surface-dark border border-border-dark peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all group-hover:scale-[1.02]">
                                            <span class="material-symbols-outlined text-xl mb-1" aria-hidden="true">search</span>
                                            <span class="text-[10px] font-medium">SEO</span>
                                        </div>
                                        <span id="style-seo-desc" class="sr-only">SEO에 최적화된 형태로 작성합니다</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Custom Styles Section -->
                        <div id="custom-styles-section" class="hidden mb-4" role="region" aria-label="사용자 정의 스타일">
                            <span id="style-custom-label" class="text-[10px] font-semibold text-text-secondary uppercase tracking-wider mb-2.5 block flex items-center gap-1.5">
                                <span class="w-1.5 h-1.5 bg-purple-400 rounded-full" aria-hidden="true"></span>
                                My Styles
                            </span>
                            <div id="custom-styles-grid" class="grid grid-cols-4 gap-2">
                                <!-- Custom styles will be inserted here -->
                            </div>
                        </div>

                        <!-- AI Style Generate Button -->
                        <button id="generate-style-btn" class="w-full px-3 py-2.5 rounded-xl border border-border-dark hover:border-primary bg-gradient-to-r from-primary/5 to-purple-500/5 text-text-secondary hover:text-primary text-xs font-medium transition-all flex items-center justify-center gap-2 hover:shadow-lg hover:shadow-primary/10" aria-label="AI 스타일 생성: 영상에 맞는 맞춤 프롬프트를 자동 생성합니다">
                            <span class="material-symbols-outlined text-base" aria-hidden="true">auto_awesome</span>
                            <span>AI 스타일 생성</span>
                        </button>
                    </fieldset>

                    <!-- ===== 모디파이어 옵션 (칩 형태) ===== -->
                    <div class="border-b border-border-dark">
                        <button id="advanced-options-toggle" class="w-full p-4 flex items-center justify-between text-text-secondary hover:text-white transition-colors" aria-expanded="false" aria-controls="advanced-options-panel">
                            <div class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-sm text-primary" aria-hidden="true">tune</span>
                                <span class="text-sm font-medium">모디파이어</span>
                            </div>
                            <span class="material-symbols-outlined text-sm transition-transform" id="advanced-options-arrow" aria-hidden="true">expand_more</span>
                        </button>
                        <div id="advanced-options-panel" class="hidden p-4 pt-0 space-y-4" role="region" aria-label="콘텐츠 생성 옵션">
                            <!-- 길이 - 칩 형태 -->
                            <div class="modifier-group" role="group" aria-labelledby="length-label">
                                <span id="length-label" class="flex items-center gap-1.5 text-[10px] font-semibold text-text-secondary mb-2.5 uppercase tracking-wider">
                                    <span class="material-symbols-outlined text-xs text-amber-500" aria-hidden="true">straighten</span>
                                    길이
                                </span>
                                <div class="flex flex-wrap gap-2" role="radiogroup" aria-labelledby="length-label">
                                    <label class="modifier-chip cursor-pointer">
                                        <input type="radio" name="length" value="short" class="peer sr-only"/>
                                        <div class="chip-content px-3 py-1.5 rounded-full border border-border-dark bg-surface-dark peer-checked:border-primary peer-checked:bg-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all text-xs font-medium flex items-center gap-1.5">
                                            <span class="material-symbols-outlined text-sm" aria-hidden="true">short_text</span>
                                            짧게
                                        </div>
                                    </label>
                                    <label class="modifier-chip cursor-pointer">
                                        <input type="radio" name="length" value="medium" checked class="peer sr-only"/>
                                        <div class="chip-content px-3 py-1.5 rounded-full border border-border-dark bg-surface-dark peer-checked:border-primary peer-checked:bg-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all text-xs font-medium flex items-center gap-1.5">
                                            <span class="material-symbols-outlined text-sm" aria-hidden="true">notes</span>
                                            보통
                                        </div>
                                    </label>
                                    <label class="modifier-chip cursor-pointer">
                                        <input type="radio" name="length" value="long" class="peer sr-only"/>
                                        <div class="chip-content px-3 py-1.5 rounded-full border border-border-dark bg-surface-dark peer-checked:border-primary peer-checked:bg-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all text-xs font-medium flex items-center gap-1.5">
                                            <span class="material-symbols-outlined text-sm" aria-hidden="true">subject</span>
                                            상세
                                        </div>
                                    </label>
                                </div>
                            </div>
                            <!-- 톤 - 칩 형태 -->
                            <div class="modifier-group" role="group" aria-labelledby="tone-label">
                                <span id="tone-label" class="flex items-center gap-1.5 text-[10px] font-semibold text-text-secondary mb-2.5 uppercase tracking-wider">
                                    <span class="material-symbols-outlined text-xs text-emerald-500" aria-hidden="true">record_voice_over</span>
                                    톤
                                </span>
                                <div class="flex flex-wrap gap-2" role="radiogroup" aria-labelledby="tone-label">
                                    <label class="modifier-chip cursor-pointer">
                                        <input type="radio" name="tone" value="professional" checked class="peer sr-only"/>
                                        <div class="chip-content px-3 py-1.5 rounded-full border border-border-dark bg-surface-dark peer-checked:border-primary peer-checked:bg-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all text-xs font-medium flex items-center gap-1.5">
                                            <span class="material-symbols-outlined text-sm" aria-hidden="true">business_center</span>
                                            전문적
                                        </div>
                                    </label>
                                    <label class="modifier-chip cursor-pointer">
                                        <input type="radio" name="tone" value="friendly" class="peer sr-only"/>
                                        <div class="chip-content px-3 py-1.5 rounded-full border border-border-dark bg-surface-dark peer-checked:border-primary peer-checked:bg-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all text-xs font-medium flex items-center gap-1.5">
                                            <span class="material-symbols-outlined text-sm" aria-hidden="true">sentiment_satisfied</span>
                                            친근
                                        </div>
                                    </label>
                                    <label class="modifier-chip cursor-pointer">
                                        <input type="radio" name="tone" value="humorous" class="peer sr-only"/>
                                        <div class="chip-content px-3 py-1.5 rounded-full border border-border-dark bg-surface-dark peer-checked:border-primary peer-checked:bg-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all text-xs font-medium flex items-center gap-1.5">
                                            <span class="material-symbols-outlined text-sm" aria-hidden="true">mood</span>
                                            유머
                                        </div>
                                    </label>
                                </div>
                            </div>
                            <!-- 언어 & 이모지 - 칩 형태 -->
                            <div class="grid grid-cols-2 gap-4">
                                <div class="modifier-group" role="group" aria-labelledby="language-label">
                                    <span id="language-label" class="flex items-center gap-1.5 text-[10px] font-semibold text-text-secondary mb-2.5 uppercase tracking-wider">
                                        <span class="material-symbols-outlined text-xs text-blue-500" aria-hidden="true">translate</span>
                                        언어
                                    </span>
                                    <div class="flex flex-wrap gap-2" role="radiogroup" aria-labelledby="language-label">
                                        <label class="modifier-chip cursor-pointer">
                                            <input type="radio" name="language" value="ko" checked class="peer sr-only"/>
                                            <div class="chip-content px-3 py-1.5 rounded-full border border-border-dark bg-surface-dark peer-checked:border-primary peer-checked:bg-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all text-xs font-medium">
                                                한국어
                                            </div>
                                        </label>
                                        <label class="modifier-chip cursor-pointer">
                                            <input type="radio" name="language" value="en" class="peer sr-only"/>
                                            <div class="chip-content px-3 py-1.5 rounded-full border border-border-dark bg-surface-dark peer-checked:border-primary peer-checked:bg-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all text-xs font-medium">
                                                EN
                                            </div>
                                        </label>
                                        <label class="modifier-chip cursor-pointer">
                                            <input type="radio" name="language" value="ja" class="peer sr-only"/>
                                            <div class="chip-content px-3 py-1.5 rounded-full border border-border-dark bg-surface-dark peer-checked:border-primary peer-checked:bg-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all text-xs font-medium">
                                                日本語
                                            </div>
                                        </label>
                                    </div>
                                    <!-- 기존 select 숨김 처리 (JS 호환성) -->
                                    <select id="language-select" class="hidden" aria-hidden="true">
                                        <option value="ko">한국어</option>
                                        <option value="en">English</option>
                                        <option value="ja">日本語</option>
                                    </select>
                                </div>
                                <div class="modifier-group" role="group" aria-labelledby="emoji-label">
                                    <span id="emoji-label" class="flex items-center gap-1.5 text-[10px] font-semibold text-text-secondary mb-2.5 uppercase tracking-wider">
                                        <span class="material-symbols-outlined text-xs text-pink-500" aria-hidden="true">add_reaction</span>
                                        이모지
                                    </span>
                                    <div class="flex flex-wrap gap-2">
                                        <label class="modifier-chip cursor-pointer">
                                            <input type="checkbox" id="emoji-checkbox" class="peer sr-only" aria-labelledby="emoji-label"/>
                                            <div class="chip-content px-3 py-1.5 rounded-full border border-border-dark bg-surface-dark peer-checked:border-primary peer-checked:bg-primary peer-checked:text-white text-text-secondary hover:border-primary/50 transition-all text-xs font-medium flex items-center gap-1.5">
                                                <span class="material-symbols-outlined text-sm" aria-hidden="true">sentiment_very_satisfied</span>
                                                사용
                                            </div>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ===== 생성 버튼 (하단 고정) ===== -->
                    <div class="p-4 mt-auto">
                        <button id="run-analysis-btn" class="relative w-full bg-primary hover:bg-primary-hover text-white font-semibold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2" aria-describedby="pending-badge-desc">
                            <span class="material-symbols-outlined text-xl" id="run-icon" aria-hidden="true">auto_awesome</span>
                            <span id="run-text">콘텐츠 생성</span>
                            <span id="pending-badge" class="hidden absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold min-w-[20px] h-5 flex items-center justify-center rounded-full px-1.5 shadow-lg animate-pulse" role="status" aria-live="polite">0</span>
                            <span id="pending-badge-desc" class="sr-only">대기 중인 URL 개수</span>
                        </button>
                    </div>
                </section>

                <!-- ==================== 결과 패널 (flex-1) ==================== -->
                <section id="result-panel" class="flex flex-col bg-background-dark" role="region" aria-label="생성 결과">
                    <!-- ===== Dashboard View (기존) ===== -->
                    <div id="dashboard-view" class="panel-view" role="tabpanel" aria-labelledby="dashboard-tab">
                        <!-- 헤더 -->
                        <div class="p-4 border-b border-border-dark flex-shrink-0">
                            <div class="flex items-center justify-between">
                                <h2 class="text-lg font-semibold text-white">결과</h2>
                                <div id="live-indicator" class="hidden flex items-center gap-2 text-xs text-primary" role="status" aria-live="polite">
                                    <span class="w-2 h-2 bg-primary rounded-full animate-pulse" aria-hidden="true"></span>
                                    <span>생성 중</span>
                                    <span class="sr-only">콘텐츠 생성이 진행 중입니다</span>
                                </div>
                            </div>
                        </div>
                        <!-- 리포트 스트림 -->
                        <div id="report-stream" class="flex-1 p-4 space-y-2 overflow-y-auto" role="feed" aria-label="생성된 콘텐츠 목록" aria-live="polite"></div>
                        <!-- Empty State -->
                        <div id="empty-state" class="flex-1 flex flex-col items-center justify-center p-8 text-center" role="status">
                            <span class="material-symbols-outlined text-6xl text-text-muted mb-4" aria-hidden="true">article</span>
                            <p class="text-text-muted text-lg mb-2">생성된 콘텐츠가 없습니다</p>
                            <p class="text-text-muted text-sm">왼쪽에서 URL을 입력하고 콘텐츠를 생성하세요</p>
                        </div>
                    </div>

                    <!-- ===== History View (신규) ===== -->
                    <div id="history-view" class="panel-view hidden overflow-hidden" role="tabpanel" aria-labelledby="history-tab">
                        <!-- 헤더 -->
                        <div class="p-4 border-b border-border-dark flex-shrink-0">
                            <div class="flex items-center justify-between">
                                <h2 class="text-lg font-semibold text-white flex items-center gap-2">
                                    <span class="material-symbols-outlined" aria-hidden="true">history</span>
                                    히스토리
                                </h2>
                                <button id="clear-all-history-btn" class="text-xs text-text-muted hover:text-red-400 transition-colors flex items-center gap-1" aria-label="전체 히스토리 삭제">
                                    <span class="material-symbols-outlined text-sm" aria-hidden="true">delete</span>
                                    전체 삭제
                                </button>
                            </div>
                        </div>
                        <!-- 히스토리 목록 -->
                        <div id="history-list" class="flex-1 p-4 space-y-3 overflow-y-auto overflow-x-hidden" role="list" aria-label="히스토리 목록"></div>
                        <!-- Empty State -->
                        <div id="history-empty-state" class="flex-1 flex flex-col items-center justify-center p-8 text-center" role="status">
                            <span class="material-symbols-outlined text-6xl text-text-muted mb-4" aria-hidden="true">history</span>
                            <p class="text-text-muted text-lg mb-2">히스토리가 없습니다</p>
                            <p class="text-text-muted text-sm">콘텐츠를 생성하면 여기에 기록됩니다</p>
                        </div>
                        <!-- 푸터 -->
                        <div id="history-footer" class="p-3 border-t border-border-dark text-xs text-text-muted text-center hidden" role="status">
                            총 <span id="history-count">0</span>개 항목 • 최대 50개 저장
                        </div>
                    </div>

                    <!-- ===== Usage View (신규) ===== -->
                    <div id="usage-view" class="panel-view hidden" role="tabpanel" aria-labelledby="usage-tab">
                        <!-- 헤더 -->
                        <div class="p-4 border-b border-border-dark flex-shrink-0">
                            <h2 class="text-lg font-semibold text-white flex items-center gap-2">
                                <span class="material-symbols-outlined" aria-hidden="true">bar_chart</span>
                                사용량
                            </h2>
                        </div>
                        <!-- 사용량 대시보드 -->
                        <div class="flex-1 p-4 space-y-6 overflow-y-auto">
                            <!-- 오늘 사용량 카드 -->
                            <div class="bg-card-dark border border-card-border rounded-xl p-4" role="region" aria-labelledby="today-usage-title">
                                <h3 id="today-usage-title" class="text-sm font-medium text-text-muted mb-3">오늘 사용량</h3>
                                <div class="space-y-2">
                                    <div class="flex justify-between text-sm">
                                        <span id="usage-current" class="text-white font-semibold" aria-label="현재 사용 횟수">0</span>
                                        <span id="usage-limit" class="text-text-muted" aria-label="일일 제한">/ 5</span>
                                    </div>
                                    <div class="h-2 bg-background-dark rounded-full overflow-hidden" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="사용량 진행률">
                                        <div id="usage-progress-bar" class="h-full bg-primary rounded-full transition-all" style="width: 0%"></div>
                                    </div>
                                    <p id="usage-remaining" class="text-xs text-text-muted" role="status" aria-live="polite">남은 횟수: 5회</p>
                                </div>
                            </div>

                            <!-- 최근 7일 그래프 -->
                            <div class="bg-card-dark border border-card-border rounded-xl p-4" role="region" aria-labelledby="weekly-chart-title">
                                <h3 id="weekly-chart-title" class="text-sm font-medium text-text-muted mb-4">최근 7일</h3>
                                <div id="weekly-chart" class="flex items-end justify-between h-32 gap-2" role="img" aria-label="최근 7일간 사용량 차트">
                                    <!-- 바 차트 (JS로 생성) -->
                                </div>
                            </div>

                            <!-- 스타일별 통계 -->
                            <div class="bg-card-dark border border-card-border rounded-xl p-4" role="region" aria-labelledby="style-stats-title">
                                <h3 id="style-stats-title" class="text-sm font-medium text-text-muted mb-4">스타일별 사용</h3>
                                <div id="style-stats" class="space-y-3" role="list" aria-label="스타일별 사용 통계">
                                    <!-- 스타일 바 (JS로 생성) -->
                                </div>
                                <p id="style-stats-empty" class="text-center text-text-muted text-sm py-4 hidden" role="status">통계 데이터가 없습니다</p>
                            </div>
                        </div>
                    </div>
                </section>
        </main>
    </div><!-- End Main Content Area -->

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Markmap for mindmap visualization -->
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdn.jsdelivr.net/npm/markmap-view@0.15.4"></script>
    <script src="https://cdn.jsdelivr.net/npm/markmap-lib@0.15.4"></script>

    <!-- Supabase JS SDK (PKCE OAuth Flow) - main.js보다 먼저 로드 -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Sidebar Toggle Script -->
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebar-overlay');
            const hamburgerBtn = document.getElementById('hamburger-btn');
            const isOpen = sidebar.classList.contains('sidebar-open');

            if (isOpen) {
                sidebar.classList.remove('sidebar-open');
                overlay.classList.remove('active');
                hamburgerBtn?.classList.remove('active');
                hamburgerBtn?.setAttribute('aria-expanded', 'false');
            } else {
                sidebar.classList.add('sidebar-open');
                overlay.classList.add('active');
                hamburgerBtn?.classList.add('active');
                hamburgerBtn?.setAttribute('aria-expanded', 'true');
            }
        }

        // Close sidebar when clicking overlay
        document.getElementById('sidebar-overlay')?.addEventListener('click', toggleSidebar);

        // Close sidebar on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const sidebar = document.getElementById('sidebar');
                if (sidebar?.classList.contains('sidebar-open')) {
                    toggleSidebar();
                }
            }
        });

        // 탭(패널 뷰) 전환
        function switchPanelView(viewName) {
            // 모든 패널 뷰 숨기기
            document.querySelectorAll('.panel-view').forEach(view => {
                view.classList.add('hidden');
            });

            // 선택한 뷰만 표시
            const targetView = document.getElementById(`${viewName}-view`);
            if (targetView) {
                targetView.classList.remove('hidden');
            }

            // 아이콘 버튼 활성화 상태 업데이트
            document.querySelectorAll('.nav-icon-btn[data-section]').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.section === viewName);
            });

            // 뷰별 초기화 이벤트
            if (viewName === 'history') {
                window.dispatchEvent(new CustomEvent('panel:history-opened'));
            } else if (viewName === 'usage') {
                window.dispatchEvent(new CustomEvent('panel:usage-opened'));
            }
        }

        // 아이콘 바 버튼 클릭 이벤트 (Dashboard, History, Usage)
        document.querySelectorAll('.nav-icon-btn[data-section]').forEach(btn => {
            btn.addEventListener('click', () => {
                const section = btn.dataset.section;
                if (section && section !== 'settings') {
                    switchPanelView(section);
                    if (window.innerWidth < 1024) toggleSidebar();
                }
            });
        });

        // 전역으로 노출 (다른 모듈에서 사용)
        window.switchPanelView = switchPanelView;

        // Sidebar settings button
        document.getElementById('sidebar-settings-btn')?.addEventListener('click', () => {
            document.getElementById('settings-modal')?.classList.add('active');
            if (window.innerWidth < 1024) toggleSidebar();
        });

        // Sidebar auth container click
        document.getElementById('sidebar-auth-container')?.addEventListener('click', () => {
            document.getElementById('auth-modal')?.classList.add('active');
            if (window.innerWidth < 1024) toggleSidebar();
        });
    </script>

    <script type="module" src="/static/js/main.js"></script>

    <!-- ==================== Mobile Bottom Navigation ==================== -->
    <nav id="mobile-bottom-nav" class="lg:hidden fixed bottom-0 left-0 right-0 z-50 bg-background-dark/95 backdrop-blur-md border-t border-card-border/50" role="navigation" aria-label="모바일 하단 메뉴">
        <div class="grid grid-cols-4 h-14 pb-safe" role="tablist">
            <button class="mobile-nav-item active" data-section="dashboard" onclick="scrollToSection('url-input')" role="tab" aria-selected="true" aria-label="홈으로 이동">
                <span class="material-symbols-outlined" aria-hidden="true">dashboard</span>
                <span>홈</span>
            </button>
            <button class="mobile-nav-item" data-section="styles" onclick="scrollToSection('style-options')" role="tab" aria-selected="false" aria-label="스타일 선택으로 이동">
                <span class="material-symbols-outlined" aria-hidden="true">palette</span>
                <span>스타일</span>
            </button>
            <button class="mobile-nav-item" data-section="reports" onclick="scrollToSection('report-stream')" role="tab" aria-selected="false" aria-label="리포트 영역으로 이동">
                <span class="material-symbols-outlined" aria-hidden="true">article</span>
                <span>리포트</span>
            </button>
            <button class="mobile-nav-item" data-section="settings" onclick="document.getElementById('settings-modal')?.classList.add('active')" role="tab" aria-selected="false" aria-label="설정 열기" aria-haspopup="dialog">
                <span class="material-symbols-outlined" aria-hidden="true">settings</span>
                <span>설정</span>
            </button>
        </div>
    </nav>
    <script>
        function scrollToSection(elementId) {
            const element = document.getElementById(elementId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            // Update active state
            document.querySelectorAll('.mobile-nav-item').forEach(btn => btn.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }
    </script>

    <!-- 모바일 탭 바 (768px 이하에서만 표시) -->
    <nav class="mobile-tab-bar" role="tablist" aria-label="모바일 패널 전환">
        <button class="mobile-tab active" data-panel="input" role="tab" aria-selected="true" aria-controls="input-panel">
            <span class="material-symbols-outlined" aria-hidden="true">edit</span>
            <span>입력</span>
        </button>
        <button class="mobile-tab" data-panel="result" role="tab" aria-selected="false" aria-controls="result-panel">
            <span class="material-symbols-outlined" aria-hidden="true">article</span>
            <span>결과</span>
        </button>
        <button class="mobile-tab" data-panel="settings" onclick="document.getElementById('settings-modal')?.classList.add('active')" role="tab" aria-selected="false" aria-haspopup="dialog">
            <span class="material-symbols-outlined" aria-hidden="true">settings</span>
            <span>설정</span>
        </button>
    </nav>

    <script>
        // 모바일 탭 전환
        document.querySelectorAll('.mobile-tab[data-panel]').forEach(tab => {
            tab.addEventListener('click', () => {
                const panel = tab.dataset.panel;
                if (panel === 'settings') return;

                document.querySelectorAll('.mobile-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                document.getElementById('input-panel')?.classList.toggle('active', panel === 'input');
                document.getElementById('result-panel')?.classList.toggle('active', panel === 'result');
            });
        });

        // 모바일 초기 상태: 768px 이하에서 입력 패널 활성화
        if (window.innerWidth <= 768) {
            document.getElementById('input-panel')?.classList.add('active');
        }

        // 화면 크기 변경 시 패널 상태 조정
        window.addEventListener('resize', () => {
            if (window.innerWidth <= 768) {
                // 모바일: 탭 상태에 따라 패널 표시
                const activeTab = document.querySelector('.mobile-tab.active');
                const activePanel = activeTab?.dataset.panel;
                if (activePanel && activePanel !== 'settings') {
                    document.getElementById('input-panel')?.classList.toggle('active', activePanel === 'input');
                    document.getElementById('result-panel')?.classList.toggle('active', activePanel === 'result');
                }
            }
        });
    </script>
</body>
</html>
